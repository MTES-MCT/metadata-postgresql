
<!DOCTYPE html>

<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Création d’un nouveau widget &#8212; Documentation Plume 0.3.0-beta</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="next" title="Actions contrôlées par les widgets du formulaire" href="actions_widgets.html" />
    <link rel="prev" title="Génération du dictionnaire des widgets" href="generation_dictionnaire_widgets.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="creation-d-un-nouveau-widget">
<h1>Création d’un nouveau widget<a class="headerlink" href="#creation-d-un-nouveau-widget" title="Lien permanent vers ce titre">¶</a></h1>
<p>La présente page explique comment créer les widgets - <code class="docutils literal notranslate"><span class="pre">QtWidgets.QWidget</span></code> - et autres objets QT (<code class="docutils literal notranslate"><span class="pre">QtWidgets.QGridLayout</span></code>, <code class="docutils literal notranslate"><span class="pre">QtWidgets.QMenu</span></code>, <code class="docutils literal notranslate"><span class="pre">QtGui.QAction</span></code>) qui formeront le formulaire de consultation / édition des métadonnées à partir du <span class="xref myst">dictionnaire des widgets</span>. On suppose que le programme est en train de boucler sur les clés dudit dictionnaire.</p>
<p>Soit :</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">widgetsdict</span></code> le dictionnaire contenant tous les widgets et leurs informations de paramétrage (cf. <span class="xref myst">Génération du dictionnaire des widgets</span>), objet de classe <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">plume.rdf.widgetsdict.WidgetsDict</span></code></span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">widgetkey</span></code> la clé de l’enregistrement en cours de traitement, objet de classe <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">plume.rdf.widgetkey.WidgetKey</span></code></span>.</p></li>
</ul>
<p>La valeur associée à <code class="docutils literal notranslate"><span class="pre">widgetkey</span></code> dans le dictionnaire de widgets, c’est-à-dire <code class="docutils literal notranslate"><span class="pre">widgetsdict[widgetkey]</span></code>, est un objet de classe <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">plume.rdf.internaldict.InternalDict</span></code></span> dit « dictionnaire interne ».</p>
<p>Chaque enregistrement du dictionnaire des widgets contrôle un widget principal et, le cas échéant, un ou plusieurs widgets annexes. Non seulement son dictionnaire interne donne les informations nécessaires à leur création, mais certaines de ses clés servent à référencer les objets Qt créés.</p>
<p><strong>Widget principal</strong> : <span class="xref myst">Type</span> • <span class="xref myst">Stockage</span> • <span class="xref myst">Placement dans la grille</span> • <span class="xref myst">Widget masqué ?</span> • <span class="xref myst">Paramètres spécifiques aux widgets QGroupBox</span> • <span class="xref myst">Paramètres spécifiques aux widgets QToolButton</span> • <span class="xref myst">Paramètres spécifiques aux widgets de saisie</span> • <span class="xref myst">Paramètres spécifiques aux widgets QLineEdit et QTextEdit</span> • <span class="xref myst">Paramètres spécifiques aux widgets QComboBox</span> • <span class="xref myst">Paramètres spécifiques aux widgets QDateEdit, QDateTimeEdit et QTimeEdit</span> • <span class="xref myst">Paramètres spécifiques aux widgets QLabel</span></p>
<p><strong>Widgets annexes</strong> : <span class="xref myst">Widget annexe : grille</span> • <span class="xref myst">Widget annexe : étiquette</span> • <span class="xref myst">Widget annexe : bouton de sélection de la source</span> • <span class="xref myst">Widget annexe : bouton de sélection de la langue</span> • <span class="xref myst">Widget annexe : bouton de sélection de l’unité</span> • <span class="xref myst">Widget annexe : bouton d’aide à la saisie des géométries</span> • <span class="xref myst">Widget annexe : bouton « moins »</span> • <span class="xref myst">Widget annexe : bouton de calcul</span></p>
<p>Le widget principal et les widgets annexes sont totalement indépendants. Ils peuvent être simplement créés les uns à la suite des autres, de la manière suivante :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
    <span class="c1"># commandes de création du widget principal, variables</span>
    <span class="c1"># selon le type :</span>
    <span class="k">if</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;main widget type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;QGroupBox&#39;</span><span class="p">:</span>
        <span class="o">...</span>	
    <span class="k">elif</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;main widget type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="o">...</span>
        <span class="o">...</span>
    <span class="c1"># etc.</span>

    <span class="c1"># commandes de création du widget annexe d&#39;étiquette,</span>
    <span class="c1"># s&#39;il y a lieu :</span>
    <span class="k">if</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;has label&#39;</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="c1"># commandes de création du widget annexe de sélection de</span>
    <span class="c1"># la source, s&#39;il y a lieu :</span>
    <span class="k">if</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;multiple sources&#39;</span><span class="p">]:</span>
        <span class="o">...</span>
        
    <span class="c1"># commandes de création du widget annexe de sélection de</span>
    <span class="c1"># la langue, s&#39;il y a lieu :</span>
    <span class="k">if</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;authorized languages&#39;</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="c1"># commandes de création du widget annexe de sélection de</span>
    <span class="c1"># l&#39;unité, s&#39;il y a lieu :</span>
    <span class="k">if</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;units&#39;</span><span class="p">]:</span>
        <span class="o">...</span>
    
    <span class="c1"># commandes de création du widget annexe d&#39;aide à la saisie</span>
    <span class="c1"># des géométries, s&#39;il y a lieu :</span>
    <span class="k">if</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;geo tools&#39;</span><span class="p">]:</span>
        <span class="o">...</span>
    
    <span class="c1"># commandes de création du widget annexe bouton moins,</span>
    <span class="c1"># s&#39;il y a lieu :</span>
    <span class="k">if</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;has minus button&#39;</span><span class="p">]:</span>
        <span class="o">...</span>

    <span class="c1"># commandes de création du widget annexe de calcul,</span>
    <span class="c1"># s&#39;il y a lieu :</span>
    <span class="k">if</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;has compute button&#39;</span><span class="p">]:</span>
        <span class="o">...</span>

</pre></div>
</div>
<p>Les commandes à exécuter sont détaillées dans la suite.</p>
<section id="widget-principal">
<h2>Widget principal<a class="headerlink" href="#widget-principal" title="Lien permanent vers ce titre">¶</a></h2>
<section id="type">
<h3>Type<a class="headerlink" href="#type" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le type du widget principal (<code class="docutils literal notranslate"><span class="pre">QGroupBox</span></code>, <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code>, <code class="docutils literal notranslate"><span class="pre">QLineEdit</span></code>…) est fourni par la clé <code class="docutils literal notranslate"><span class="pre">'main</span> <span class="pre">widget</span> <span class="pre">type'</span></code> du dictionnaire interne.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;main widget type&#39;</span><span class="p">]</span>

</pre></div>
</div>
<p><em>Si <code class="docutils literal notranslate"><span class="pre">'main</span> <span class="pre">widget</span> <span class="pre">type'</span></code> ne contient aucune valeur, il n’y a pas lieu de créer de widget. Ceci ne se produit en pratique que pour la clé-racine du dictionnaire, qui est également référencée par l’attribut <code class="docutils literal notranslate"><span class="pre">plume.rdf.widgetsdict.WidgetsDict.root</span></code> et n’appelle aucune action.</em></p>
</section>
<section id="stockage">
<h3>Stockage<a class="headerlink" href="#stockage" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le nouveau widget a vocation à être stocké dans la clé <code class="docutils literal notranslate"><span class="pre">'main</span> <span class="pre">widget'</span></code> du dictionnaire interne.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;main widget&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">main_widget</span>

</pre></div>
</div>
<p><em>Où <code class="docutils literal notranslate"><span class="pre">main_widget</span></code> est le widget principal qui vient d’être créé.</em></p>
</section>
<section id="placement-dans-la-grille">
<h3>Placement dans la grille<a class="headerlink" href="#placement-dans-la-grille" title="Lien permanent vers ce titre">¶</a></h3>
<p><em>Les informations ci-après ne valent pas pour les onglets (cf. <span class="xref myst">Onglets</span>).</em></p>
<p>Le nouveau widget doit être placé dans le <code class="docutils literal notranslate"><span class="pre">QGridLayout</span></code> associé à la clé parente, obtenu grâce à la méthode <code class="docutils literal notranslate"><span class="pre">plume.rdf.widgetsdict.WidgetsDict.parent_grid</span></code>.</p>
<p>Les paramètres de placement du widget dans la grille - soit les arguments <code class="docutils literal notranslate"><span class="pre">row</span></code>, <code class="docutils literal notranslate"><span class="pre">column</span></code>, <code class="docutils literal notranslate"><span class="pre">rowSpan</span></code> et <code class="docutils literal notranslate"><span class="pre">columnSpan</span></code> de la méthode <code class="docutils literal notranslate"><span class="pre">QGridLayout.addWidget</span></code> - sont donnés par la méthode <code class="docutils literal notranslate"><span class="pre">plume.rdf.widgetsdict.WidgetsDict.widget_placement</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">rowSpan</span><span class="p">,</span> <span class="n">columnSpan</span> <span class="o">=</span> <span class="n">widgetsdict</span><span class="o">.</span><span class="n">widget_placement</span><span class="p">(</span><span class="n">widgetkey</span><span class="p">,</span> <span class="s1">&#39;main widget&#39;</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">widgetsdict</span><span class="o">.</span><span class="n">parent_grid</span><span class="p">(</span><span class="n">widgetkey</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">main_widget</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">rowSpan</span><span class="p">,</span> <span class="n">columnSpan</span><span class="p">)</span>

</pre></div>
</div>
<p><em><code class="docutils literal notranslate"><span class="pre">main_widget</span></code> est le widget principal qui vient d’être créé. Le second paramètre de <code class="docutils literal notranslate"><span class="pre">widget_placement</span></code> indique que les coordonnées demandées sont celles du widget principal de la clé. La même méthode sera utilisée ensuite pour connaître le placement de ses widgets annexes, avec en second argument le nom du widget annexe considéré.</em></p>
<p>Les grilles sont elles-mêmes des widgets annexes associés aux clés de groupes. Cf. <span class="xref myst">Widget annexe : grille</span>.</p>
<p><span class="xref myst">↑ haut de page</span></p>
</section>
<section id="widget-masque">
<h3>Widget masqué ?<a class="headerlink" href="#widget-masque" title="Lien permanent vers ce titre">¶</a></h3>
<p>Certains widgets seront à masquer ou afficher selon les actions de l’utilisateur. Ceci concerne par exemple les boutons de traduction, qui devront être masqués si une traduction a déjà été saisie pour chacune des langues autorisées. Autre cas : lorsqu’une métadonnée peut être saisie au choix sous la forme d’un URI ou d’un ensemble de propriétés littérales, les widgets servant pour la forme non sélectionnée sont masqués tant que l’utilisateur ne décide pas de changer de source (cf. <span class="xref myst">Widget annexe : bouton de sélection de la source</span>).</p>
<p>Concrètement, le widget principal <strong>et tous les widgets annexes</strong> d’un enregistrement devront être masqués dès lors que la clé <code class="docutils literal notranslate"><span class="pre">'hidden'</span></code> vaut <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">if</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;hidden&#39;</span><span class="p">]:</span>
    <span class="o">...</span>

</pre></div>
</div>
</section>
<section id="parametres-specifiques-aux-widgets-qgroupbox">
<h3>Paramètres spécifiques aux widgets QGroupBox<a class="headerlink" href="#parametres-specifiques-aux-widgets-qgroupbox" title="Lien permanent vers ce titre">¶</a></h3>
<p>Deux cas doivent être distingués lorsque <code class="docutils literal notranslate"><span class="pre">'main</span> <span class="pre">widget</span> <span class="pre">type'</span></code> vaut <code class="docutils literal notranslate"><span class="pre">'QGroupBox'</span></code> : les onglets et les autres groupes.</p>
<section id="onglets">
<h4>Onglets<a class="headerlink" href="#onglets" title="Lien permanent vers ce titre">¶</a></h4>
<p>Les onglets sont reconnaissables au fait que la condition suivante est remplie :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">if</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;object&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;tab&#39;</span><span class="p">:</span>
    <span class="o">...</span>

</pre></div>
</div>
<p>Ils correspondent aux onglets du formulaire. Contrairement à tous les autres widgets, ils n’auront donc pas vocation à être placés dans un <code class="docutils literal notranslate"><span class="pre">QGridLayout</span></code> (la partie <span class="xref myst">Placement dans la grille</span> ne s’applique pas à eux), mais devront être insérés en tant que pages dans le <code class="docutils literal notranslate"><span class="pre">QTabWidget</span></code> qui portera le formulaire. Le <code class="docutils literal notranslate"><span class="pre">QTabWidget</span></code> en question ne fait pas l’objet d’un enregistrement du dictionnaire et devra avoir été créé au préalable.</p>
<p>Les libellés des onglets sont, comme pour toutes les étiquettes, fournis par la clé <code class="docutils literal notranslate"><span class="pre">'label'</span></code> du dictionnaire interne.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>

</pre></div>
</div>
</section>
<section id="autres-groupes">
<h4>Autres groupes<a class="headerlink" href="#autres-groupes" title="Lien permanent vers ce titre">¶</a></h4>
<p>Pour tous les autres groupes, c’est-à-dire ceux pour lesquels la valeur de la clé <code class="docutils literal notranslate"><span class="pre">'object'</span></code> n’est pas <code class="docutils literal notranslate"><span class="pre">'tab'</span></code>.</p>
<ul class="simple">
<li><p>La partie <span class="xref myst">Placement dans la grille</span> s’applique.</p></li>
<li><p>L”<strong>étiquette</strong> - paramètre <code class="docutils literal notranslate"><span class="pre">title</span></code> du <code class="docutils literal notranslate"><span class="pre">QGroupBox</span></code> - est fournie par la clé <code class="docutils literal notranslate"><span class="pre">'label'</span></code> du dictionnaire interne.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>

</pre></div>
</div>
<p>Cette clé ne sera renseignée que s’il y a lieu d’afficher un libellé sur le groupe.</p>
<ul class="simple">
<li><p>Lorsqu’elle est renseignée, la clé <code class="docutils literal notranslate"><span class="pre">'help</span> <span class="pre">text'</span></code> fournit un <strong>texte d’aide</strong> (descriptif de la catégorie de métadonnée), qui pourrait alimenter un <code class="docutils literal notranslate"><span class="pre">toolTip</span></code> (voire un <code class="docutils literal notranslate"><span class="pre">whatsThis</span></code>).</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;main widget&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;help text&#39;</span><span class="p">])</span>

</pre></div>
</div>
<ul class="simple">
<li><p>La couleur du cadre du <code class="docutils literal notranslate"><span class="pre">QGroupBox</span></code> dépendra de la nature du groupe, soit de la valeur de la clé <code class="docutils literal notranslate"><span class="pre">'object'</span></code> ou plus simplement la valeur renvoyée par :</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="o">.</span><span class="n">group_kind</span><span class="p">(</span><span class="n">widgetkey</span><span class="p">)</span>

</pre></div>
</div>
<p>On pourra utiliser les valeurs par défaut suivantes :</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Type de groupe</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">group_kind(widgetkey)</span></code></p></th>
<th class="head"><p>Couleur</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Groupe de propriétés</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'group</span> <span class="pre">of</span> <span class="pre">properties'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'#958B62'</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Groupe de valeurs</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'group</span> <span class="pre">of</span> <span class="pre">values'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'#5770BE'</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Groupe de traduction</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'translation</span> <span class="pre">group'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'#FF8D7E'</span></code></p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="parametres-specifiques-aux-widgets-qtoolbutton">
<h3>Paramètres spécifiques aux widgets QToolButton<a class="headerlink" href="#parametres-specifiques-aux-widgets-qtoolbutton" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les seuls cas où le widget principal est un <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> sont ceux des « boutons plus » et « boutons de traduction », qui permettent à l’utilisateur d’ajouter réciproquement des valeurs ou traductions supplémentaires. La clé <code class="docutils literal notranslate"><span class="pre">'object'</span></code> vaut alors <code class="docutils literal notranslate"><span class="pre">'plus</span> <span class="pre">button'</span></code> ou <code class="docutils literal notranslate"><span class="pre">'translation</span> <span class="pre">button'</span></code>.</p>
<ul class="simple">
<li><p>L’image <img alt="plus_button.svg" src="plume/icons/buttons/plus_button.svg" /> à utiliser est toujours <span class="xref myst">plus_button.svg</span>, mais la couleur dépendra du type de groupe dans lequel se trouve le bouton, soit de la valeur renvoyée par :</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="o">.</span><span class="n">group_kind</span><span class="p">(</span><span class="n">widgetkey</span><span class="p">)</span>

</pre></div>
</div>
<p>Comme pour les <code class="docutils literal notranslate"><span class="pre">QGroupBox</span></code>, on pourra utiliser les valeurs par défaut suivantes :</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Type de groupe</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">group_kind(widgetkey)</span></code></p></th>
<th class="head"><p>Couleur</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Groupe de propriétés</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'group</span> <span class="pre">of</span> <span class="pre">properties'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'#958B62'</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Groupe de valeurs</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'group</span> <span class="pre">of</span> <span class="pre">values'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'#5770BE'</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Groupe de traduction</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'translation</span> <span class="pre">group'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'#FF8D7E'</span></code></p></td>
</tr>
</tbody>
</table>
<p><em>NB. En pratique, il n’y a pas de bouton plus dans les groupes de propriétés, donc la couleur associée ne sera jamais utilisée dans ce contexte.</em></p>
<p>Soit <code class="docutils literal notranslate"><span class="pre">color</span></code> la couleur souhaitée pour le bouton et <code class="docutils literal notranslate"><span class="pre">raw_svg</span></code> le contenu du fichier <em>plus_button.svg</em>, on pourra appliquer la couleur avec :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">colored_svg</span> <span class="o">=</span> <span class="n">raw_svg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

</pre></div>
</div>
<ul class="simple">
<li><p>Le texte d’aide à afficher en infobulle sur le bouton se trouve dans la clé <code class="docutils literal notranslate"><span class="pre">'text</span> <span class="pre">help'</span></code> du dictionnaire.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;text help&#39;</span><span class="p">]</span>

</pre></div>
</div>
</section>
<section id="parametres-specifiques-aux-widgets-de-saisie">
<h3>Paramètres spécifiques aux widgets de saisie<a class="headerlink" href="#parametres-specifiques-aux-widgets-de-saisie" title="Lien permanent vers ce titre">¶</a></h3>
<ul class="simple">
<li><p>Lorsqu’elle existe (car préalablement renseignée dans la fiche de métadonnées), la <strong>valeur à afficher</strong> dans le widget est fournie par la clé <code class="docutils literal notranslate"><span class="pre">'value'</span></code> du dictionnaire.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

</pre></div>
</div>
<p><strong>Important !</strong> Lorsque la métadonnée est supposée être calculée automatique, c’est-à-dire quand la clé <code class="docutils literal notranslate"><span class="pre">'auto</span> <span class="pre">compute'</span></code> du dictionnaire interne vaut <code class="docutils literal notranslate"><span class="pre">True</span></code>, le calcul doit être réalisé avant d’intégrer le contenu de la clé <code class="docutils literal notranslate"><span class="pre">'value'</span></code> dans le widget de saisie, afin de bien afficher la valeur à jour. Pour plus de détails, on se référera à <span class="xref myst">Métadonnées calculées</span>.</p>
<ul class="simple">
<li><p>Si la clé <code class="docutils literal notranslate"><span class="pre">'read</span> <span class="pre">only'</span></code> vaut <code class="docutils literal notranslate"><span class="pre">True</span></code>, le widget doit être visible mais désactivé, pour empêcher les modifications manuelles par l’utilisateur.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;read only&#39;</span><span class="p">]</span>

</pre></div>
</div>
<ul class="simple">
<li><p>La clé <code class="docutils literal notranslate"><span class="pre">'is</span> <span class="pre">mandatory'</span></code> contient un booléen indiquant s’il est obligatoire (valeur <code class="docutils literal notranslate"><span class="pre">True</span></code>) ou non (valeur <code class="docutils literal notranslate"><span class="pre">False</span></code> ou <code class="docutils literal notranslate"><span class="pre">None</span></code>) de saisir une valeur pour la catégorie.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;is mandatory&#39;</span><span class="p">]</span>

</pre></div>
</div>
</section>
<section id="parametres-specifiques-aux-widgets-qlineedit-et-qtextedit">
<h3>Paramètres spécifiques aux widgets QLineEdit et QTextEdit<a class="headerlink" href="#parametres-specifiques-aux-widgets-qlineedit-et-qtextedit" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pour les widgets d’édition de texte, le dictionnaire apporte divers paramètres complémentaires. Ils sont tous optionnels. Si la clé ne contient pas de valeur, c’est qu’il n’y a pas lieu d’utiliser le paramètre.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'placeholder</span> <span class="pre">text'</span></code> donne la <strong>valeur fictive</strong> à afficher dans le widget :</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;main widget&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;placeholder text&#39;</span><span class="p">])</span>

</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'input</span> <span class="pre">mask'</span></code> donne le <strong>masque de saisie</strong> :</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;main widget&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setInputMask</span><span class="p">(</span><span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;input mask&#39;</span><span class="p">])</span>

</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'type</span> <span class="pre">validator'</span></code> indique si un <strong>validateur basé sur le type</strong> doit être défini et lequel :</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">mTypeValidator</span> <span class="o">=</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;type validator&#39;</span><span class="p">]</span>

<span class="k">if</span> <span class="n">mTypeValidator</span> <span class="o">==</span> <span class="s1">&#39;QIntValidator&#39;</span><span class="p">:</span>
    <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;main widget&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setValidator</span><span class="p">(</span><span class="n">QIntValidator</span><span class="p">(</span><span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;main widget&#39;</span><span class="p">]))</span>
<span class="k">elif</span> <span class="n">mTypeValidator</span> <span class="o">==</span> <span class="s1">&#39;QDoubleValidator&#39;</span><span class="p">:</span>
    <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;main widget&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setValidator</span><span class="p">(</span><span class="n">QDoubleValidator</span><span class="p">(</span><span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;main widget&#39;</span><span class="p">]))</span>

</pre></div>
</div>
<p><em>Ces validateurs permettent également de définir des valeurs minimum et maximum autorisées. Comme le SHACL le permet également (avec <code class="docutils literal notranslate"><span class="pre">sh:minInclusive</span></code> et <code class="docutils literal notranslate"><span class="pre">sh:maxInclusive</span></code>, car les paramètres <code class="docutils literal notranslate"><span class="pre">bottom</span></code> et <code class="docutils literal notranslate"><span class="pre">top</span></code> de <code class="docutils literal notranslate"><span class="pre">QIntValidator</span></code> et <code class="docutils literal notranslate"><span class="pre">QDoubleValidator</span></code> sont inclusifs), cette possibilité pourrait être utilisée à l’avenir, mais aucune clé n’a été prévue en ce sens à ce stade.</em></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'regex</span> <span class="pre">validator</span> <span class="pre">pattern'</span></code> donne l”<strong>expression rationnelle</strong> que doit respecter la valeur saisie et <code class="docutils literal notranslate"><span class="pre">'regex</span> <span class="pre">validator</span> <span class="pre">flags'</span></code> les options éventuelles :</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">if</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;regex validator pattern&#39;</span><span class="p">]:</span>
    <span class="n">qre</span> <span class="o">=</span> <span class="n">QRegularExpression</span><span class="p">(</span><span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;regex validator pattern&#39;</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;regex validator flags&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="s1">&#39;i&#39;</span> <span class="ow">in</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;regex validator flags&#39;</span><span class="p">]:</span>
            <span class="n">qre</span><span class="o">.</span><span class="n">setPatternOptions</span><span class="p">(</span><span class="n">QRegularExpression</span><span class="o">.</span><span class="n">CaseInsensitiveOption</span><span class="p">)</span>        
        <span class="k">if</span> <span class="s1">&#39;s&#39;</span> <span class="ow">in</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;regex validator flags&#39;</span><span class="p">]:</span>
            <span class="n">qre</span><span class="o">.</span><span class="n">setPatternOptions</span><span class="p">(</span><span class="n">QRegularExpression</span><span class="o">.</span><span class="n">DotMatchesEverythingOption</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;m&#39;</span> <span class="ow">in</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;regex validator flags&#39;</span><span class="p">]:</span>
            <span class="n">qre</span><span class="o">.</span><span class="n">setPatternOptions</span><span class="p">(</span><span class="n">QRegularExpression</span><span class="o">.</span><span class="n">MultilineOption</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;x&#39;</span> <span class="ow">in</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;regex validator flags&#39;</span><span class="p">]:</span>
            <span class="n">qre</span><span class="o">.</span><span class="n">setPatternOptions</span><span class="p">(</span><span class="n">QRegularExpression</span><span class="o">.</span><span class="n">ExtendedPatternSyntaxOption</span><span class="p">)</span>

    <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;main widget&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setValidator</span><span class="p">(</span>
        <span class="n">QRegularExpressionValidator</span><span class="p">(</span><span class="n">qre</span><span class="p">,</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;main widget&#39;</span><span class="p">]))</span>

</pre></div>
</div>
<p><em>Seules les options <code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">s</span></code>, <code class="docutils literal notranslate"><span class="pre">m</span></code> et <code class="docutils literal notranslate"><span class="pre">x</span></code> sont à la fois admises en SHACL et par QT, ce sont donc les seules à être gérées.</em></p>
</section>
<section id="parametres-specifiques-aux-widgets-qcombobox">
<h3>Paramètres spécifiques aux widgets QComboBox<a class="headerlink" href="#parametres-specifiques-aux-widgets-qcombobox" title="Lien permanent vers ce titre">¶</a></h3>
<section id="liste-des-termes">
<h4>Liste des termes<a class="headerlink" href="#liste-des-termes" title="Lien permanent vers ce titre">¶</a></h4>
<p>La <strong>liste des termes</strong> à afficher dans le <code class="docutils literal notranslate"><span class="pre">QComboBox</span></code> est fournie par la clé <code class="docutils literal notranslate"><span class="pre">'thesaurus</span> <span class="pre">values'</span></code> du dictionnaire interne.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;thesaurus values&#39;</span><span class="p">]</span>

</pre></div>
</div>
<p>Cette liste présentera toujours une chaîne de caractères vide <code class="docutils literal notranslate"><span class="pre">''</span></code> en première position, pour représenter une absence de valeur. Lors de la sauvegarde, ces chaînes de caractères vides sont traitées comme des <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>Autant que possible - considérant la quantité de termes dans certains thésaurus - les <code class="docutils literal notranslate"><span class="pre">QComboBox</span></code> devraient afficher une ligne de saisie avec <strong>auto-complétion</strong>. Il est par contre important qu’ils <strong>ne permettent pas d’entrer d’autres valeurs que celles des thésaurus</strong>.</p>
</section>
<section id="placeholder">
<h4>Placeholder<a class="headerlink" href="#placeholder" title="Lien permanent vers ce titre">¶</a></h4>
<p>Comme les <code class="docutils literal notranslate"><span class="pre">QTextEdit</span></code> et <code class="docutils literal notranslate"><span class="pre">QLineEdit</span></code>, les widgets <code class="docutils literal notranslate"><span class="pre">QComboBox</span></code> peuvent afficher une <strong>valeur fictive</strong> fournie par la clé <code class="docutils literal notranslate"><span class="pre">'placeholder</span> <span class="pre">text'</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;main widget&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setPlaceholderText</span><span class="p">(</span><span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;placeholder text&#39;</span><span class="p">])</span>

</pre></div>
</div>
</section>
</section>
<section id="parametres-specifiques-aux-widgets-qdateedit-qdatetimeedit-et-qtimeedit">
<h3>Paramètres spécifiques aux widgets QDateEdit, QDateTimeEdit et QTimeEdit<a class="headerlink" href="#parametres-specifiques-aux-widgets-qdateedit-qdatetimeedit-et-qtimeedit" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les formats d’entrée (argument de <code class="docutils literal notranslate"><span class="pre">QDateTime.fromString</span></code>, <code class="docutils literal notranslate"><span class="pre">QDate.fromString</span></code> ou <code class="docutils literal notranslate"><span class="pre">QTime.fromString</span></code>), de sortie (argument de <code class="docutils literal notranslate"><span class="pre">QDateTime.toString</span></code>, <code class="docutils literal notranslate"><span class="pre">QDate.toString</span></code> ou <code class="docutils literal notranslate"><span class="pre">QTime.toString</span></code>) et d’affichage (argument de <code class="docutils literal notranslate"><span class="pre">QDateTimeEdit.setDisplayFormat</span></code>, <code class="docutils literal notranslate"><span class="pre">QDateEdit.setDisplayFormat</span></code> ou <code class="docutils literal notranslate"><span class="pre">QTimeEdit.setDisplayFormat</span></code>) sont toujours identiques :</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Type de widget</p></th>
<th class="head"><p>Format</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">QDate</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'dd/MM/yyyy'</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">QDateTime</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'dd/MM/yyyy</span> <span class="pre">hh:mm:ss'</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">QTime</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'hh:mm:ss'</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="parametres-specifiques-aux-widgets-qlabel">
<h3>Paramètres spécifiques aux widgets QLabel<a class="headerlink" href="#parametres-specifiques-aux-widgets-qlabel" title="Lien permanent vers ce titre">¶</a></h3>
<p><em>NB : il n’est pas question dans cette partie des <span class="xref myst">widgets annexes d’étiquettes</span> mais du cas où le widget principal lui-même est un QLabel.</em></p>
<p>En mode lecture, des widgets <code class="docutils literal notranslate"><span class="pre">QLabel</span></code> remplacent la plupart des widgets de saisie (à ce jour tous sauf les <code class="docutils literal notranslate"><span class="pre">QCheckBox</span></code>). Ils permettent notamment d’afficher des hyperliens cliquables.</p>
<p>Comme pour les véritables widgets de saisie, la <strong>valeur à afficher</strong> est fournie par la clé <code class="docutils literal notranslate"><span class="pre">'value'</span></code> du dictionnaire.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

</pre></div>
</div>
<p>Il importera d’activer le découpage sur plusieurs lignes :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;main widget&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setWordWrap</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

</pre></div>
</div>
<p>Ainsi sans doute que l’ouverture automatique des liens :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;main widget&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setOpenExternalLinks</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

</pre></div>
</div>
</section>
</section>
<section id="widget-annexe-grille">
<h2>Widget annexe : grille<a class="headerlink" href="#widget-annexe-grille" title="Lien permanent vers ce titre">¶</a></h2>
<p>Pour les onglets, groupes de valeurs, groupes de propriétés et groupes de traduction (en fait dès lors que <code class="docutils literal notranslate"><span class="pre">'main</span> <span class="pre">widget</span> <span class="pre">type'</span></code> vaut <code class="docutils literal notranslate"><span class="pre">'QGroupBox'</span></code>), un widget annexe <code class="docutils literal notranslate"><span class="pre">QGridLayout</span></code> doit être créé en paralèlle du <code class="docutils literal notranslate"><span class="pre">QGroupBox</span></code>.</p>
<p>Le widget <code class="docutils literal notranslate"><span class="pre">QGridLayout</span></code> sera stocké dans la clé <code class="docutils literal notranslate"><span class="pre">'grid</span> <span class="pre">widget'</span></code> du dictionnaire interne.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;grid widget&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grid</span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;main widget&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>

</pre></div>
</div>
<p><em>Où <code class="docutils literal notranslate"><span class="pre">grid</span></code> est l’objet <code class="docutils literal notranslate"><span class="pre">QGridLayout</span></code> qui vient d’être créé.</em></p>
<p><span class="xref myst">↑ haut de page</span></p>
</section>
<section id="widget-annexe-etiquette">
<h2>Widget annexe : étiquette<a class="headerlink" href="#widget-annexe-etiquette" title="Lien permanent vers ce titre">¶</a></h2>
<p>Un <code class="docutils literal notranslate"><span class="pre">QLabel</span></code> doit être créé dès lors que la clé <code class="docutils literal notranslate"><span class="pre">'has</span> <span class="pre">label'</span></code> du dictionnaire interne vaut <code class="docutils literal notranslate"><span class="pre">True</span></code>. En pratique, cela concernera les widgets de saisie dont la clé <code class="docutils literal notranslate"><span class="pre">'label'</span></code> contient une valeur. Le libellé à afficher correspond bien entendu à la valeur de la clé <code class="docutils literal notranslate"><span class="pre">'label'</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">if</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;has label&#39;</span><span class="p">]:</span>
    <span class="o">...</span>

</pre></div>
</div>
<section id="id1">
<h3>Stockage<a class="headerlink" href="#id1" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le widget <code class="docutils literal notranslate"><span class="pre">QLabel</span></code> sera stocké dans la clé <code class="docutils literal notranslate"><span class="pre">'label</span> <span class="pre">widget'</span></code> du dictionnaire interne.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;label widget&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label_widget</span>

</pre></div>
</div>
<p><em>Où <code class="docutils literal notranslate"><span class="pre">label_widget</span></code> est le widget d’étiquette qui vient d’être créé.</em></p>
</section>
<section id="id2">
<h3>Placement dans la grille<a class="headerlink" href="#id2" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le <code class="docutils literal notranslate"><span class="pre">QLabel</span></code> doit être placé dans le <code class="docutils literal notranslate"><span class="pre">QGridLayout</span></code> associé à la clé parente, obtenu grâce à la méthode <code class="docutils literal notranslate"><span class="pre">plume.rdf.widgetsdict.WidgetsDict.parent_grid</span></code>.</p>
<p>Les paramètres de placement du widget dans la grille - soit les arguments <code class="docutils literal notranslate"><span class="pre">row</span></code>, <code class="docutils literal notranslate"><span class="pre">column</span></code>, <code class="docutils literal notranslate"><span class="pre">rowSpan</span></code> et <code class="docutils literal notranslate"><span class="pre">columnSpan</span></code> de la méthode <code class="docutils literal notranslate"><span class="pre">QGridLayout.addWidget</span></code> - sont donnés par la méthode <code class="docutils literal notranslate"><span class="pre">plume.rdf.widgetsdict.WidgetsDict.widget_placement</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">rowSpan</span><span class="p">,</span> <span class="n">columnSpan</span> <span class="o">=</span> <span class="n">widgetsdict</span><span class="o">.</span><span class="n">widget_placement</span><span class="p">(</span><span class="n">widgetkey</span><span class="p">,</span> <span class="s1">&#39;label widget&#39;</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">widgetsdict</span><span class="o">.</span><span class="n">parent_grid</span><span class="p">(</span><span class="n">widgetkey</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">label_widget</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">rowSpan</span><span class="p">,</span> <span class="n">columnSpan</span><span class="p">)</span>

</pre></div>
</div>
<p><em><code class="docutils literal notranslate"><span class="pre">label_widget</span></code> est le <code class="docutils literal notranslate"><span class="pre">QLabel</span></code> qui vient d’être créé. Le second paramètre de <code class="docutils literal notranslate"><span class="pre">widget_placement</span></code> indique que les coordonnées demandées sont celles du widget annexe d’étiquette de la clé.</em></p>
</section>
<section id="texte-d-aide">
<h3>Texte d’aide<a class="headerlink" href="#texte-d-aide" title="Lien permanent vers ce titre">¶</a></h3>
<p>Lorsqu’elle est renseignée, la clé <code class="docutils literal notranslate"><span class="pre">'help</span> <span class="pre">text'</span></code> fournit un <strong>texte d’aide</strong> (descriptif de la catégorie de métadonnée), qui pourrait alimenter un <code class="docutils literal notranslate"><span class="pre">toolTip</span></code> (voire un <code class="docutils literal notranslate"><span class="pre">whatsThis</span></code>).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;label widget&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;help text&#39;</span><span class="p">])</span>

</pre></div>
</div>
</section>
<section id="id3">
<h3>Widget masqué ?<a class="headerlink" href="#id3" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le <code class="docutils literal notranslate"><span class="pre">QLabel</span></code> doit être masqué dès lors que la clé <code class="docutils literal notranslate"><span class="pre">'hidden'</span></code> vaut <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">if</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;hidden&#39;</span><span class="p">]:</span>
    <span class="o">...</span>

</pre></div>
</div>
<p><span class="xref myst">↑ haut de page</span></p>
</section>
</section>
<section id="widget-annexe-bouton-de-selection-de-la-source">
<h2>Widget annexe : bouton de sélection de la source<a class="headerlink" href="#widget-annexe-bouton-de-selection-de-la-source" title="Lien permanent vers ce titre">¶</a></h2>
<p>Un widget <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> de sélection de source doit être créé dès lors que la condition suivante est vérifiée :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">if</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;multiple sources&#39;</span><span class="p">]:</span>
    <span class="o">...</span>

</pre></div>
</div>
<section id="id4">
<h3>Stockage<a class="headerlink" href="#id4" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le widget de sélection de la source est stocké dans la clé <code class="docutils literal notranslate"><span class="pre">'switch</span> <span class="pre">source</span> <span class="pre">widget'</span></code> du dictionnaire interne.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;switch source widget&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">source_widget</span>

</pre></div>
</div>
<p><em>Où <code class="docutils literal notranslate"><span class="pre">source_widget</span></code> est le widget de sélection de la source qui vient d’être créé.</em></p>
</section>
<section id="menu">
<h3>Menu<a class="headerlink" href="#menu" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le <code class="docutils literal notranslate"><span class="pre">QMenu</span></code> associé au <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> est stocké dans la clé <code class="docutils literal notranslate"><span class="pre">'switch</span> <span class="pre">source</span> <span class="pre">menu'</span></code> du dictionnaire.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;switch source menu&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">source_menu</span>

</pre></div>
</div>
<p><em>Où <code class="docutils literal notranslate"><span class="pre">source_menu</span></code> est le <code class="docutils literal notranslate"><span class="pre">QMenu</span></code> qui vient d’être créé.</em></p>
<p>Ce <code class="docutils literal notranslate"><span class="pre">QMenu</span></code> contient une <code class="docutils literal notranslate"><span class="pre">QAction</span></code> par thésaurus utilisable pour la métadonnée. Les <code class="docutils literal notranslate"><span class="pre">QAction</span></code> sont elles-mêmes stockées dans la clé <code class="docutils literal notranslate"><span class="pre">'switch</span> <span class="pre">source</span> <span class="pre">actions'</span></code> du dictionnaire, sous la forme d’une liste.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;switch source actions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">source_action</span><span class="p">)</span>

</pre></div>
</div>
<p><em>Où <code class="docutils literal notranslate"><span class="pre">source_action</span></code> représente chaque <code class="docutils literal notranslate"><span class="pre">QAction</span></code> venant d’être créée.</em></p>
<p>Les libellés des <code class="docutils literal notranslate"><span class="pre">QAction</span></code> correspondent aux noms des thésaurus et sont fournis par la liste contenue dans la clé <code class="docutils literal notranslate"><span class="pre">'sources'</span></code> du dictionnaire :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;sources&#39;</span><span class="p">]</span>

</pre></div>
</div>
<p><em>Pour la définition des actions, cf. <span class="xref myst">Actions contrôlées par les widgets du formulaire</span>.</em></p>
<p>Il serait souhaitable de mettre en évidence le thésaurus courant - celui qui fournit les valeurs du <code class="docutils literal notranslate"><span class="pre">QComboBox</span></code> - par exemple via une icône (tandis que les autres thésaurus n’en auraient pas). Le nom de ce thésaurus courant est donné par la clé <code class="docutils literal notranslate"><span class="pre">'current</span> <span class="pre">source'</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;current source&#39;</span><span class="p">]</span>

</pre></div>
</div>
</section>
<section id="id5">
<h3>Placement dans la grille<a class="headerlink" href="#id5" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> doit être placé dans le <code class="docutils literal notranslate"><span class="pre">QGridLayout</span></code> associé à la clé parente, obtenu grâce à la méthode <code class="docutils literal notranslate"><span class="pre">plume.rdf.widgetsdict.WidgetsDict.parent_grid</span></code>.</p>
<p>Les paramètres de placement du widget dans la grille - soit les arguments <code class="docutils literal notranslate"><span class="pre">row</span></code>, <code class="docutils literal notranslate"><span class="pre">column</span></code>, <code class="docutils literal notranslate"><span class="pre">rowSpan</span></code> et <code class="docutils literal notranslate"><span class="pre">columnSpan</span></code> de la méthode <code class="docutils literal notranslate"><span class="pre">QGridLayout.addWidget</span></code> - sont donnés par la méthode <code class="docutils literal notranslate"><span class="pre">plume.rdf.widgetsdict.WidgetsDict.widget_placement</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">rowSpan</span><span class="p">,</span> <span class="n">columnSpan</span> <span class="o">=</span> <span class="n">widgetsdict</span><span class="o">.</span><span class="n">widget_placement</span><span class="p">(</span><span class="n">widgetkey</span><span class="p">,</span> <span class="s1">&#39;switch source widget&#39;</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">widgetsdict</span><span class="o">.</span><span class="n">parent_grid</span><span class="p">(</span><span class="n">widgetkey</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">source_widget</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">rowSpan</span><span class="p">,</span> <span class="n">columnSpan</span><span class="p">)</span>

</pre></div>
</div>
<p><em><code class="docutils literal notranslate"><span class="pre">source_widget</span></code> est le <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> qui vient d’être créé. Le second paramètre de <code class="docutils literal notranslate"><span class="pre">widget_placement</span></code> indique que les coordonnées demandées sont celles du widget annexe de sélection de la source.</em></p>
</section>
<section id="icone">
<h3>Icône<a class="headerlink" href="#icone" title="Lien permanent vers ce titre">¶</a></h3>
<p>L’icône <img alt="source_button.svg" src="plume/icons/buttons/source_button.svg" /> à utiliser pour le bouton de sélection de la source est fournie par le fichier <span class="xref myst">source_button.svg</span>. Contrairement aux boutons plus et moins, sa couleur est fixe à ce stade.</p>
</section>
<section id="id6">
<h3>Texte d’aide<a class="headerlink" href="#id6" title="Lien permanent vers ce titre">¶</a></h3>
<p>On pourra afficher en infobulle sur le bouton le texte suivant :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="s1">&#39;Sélection du thésaurus ou mode de saisie&#39;</span>

</pre></div>
</div>
</section>
<section id="id7">
<h3>Widget masqué ?<a class="headerlink" href="#id7" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> doit être masqué dès lors que la clé <code class="docutils literal notranslate"><span class="pre">'hidden'</span></code> vaut <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">if</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;hidden&#39;</span><span class="p">]:</span>
    <span class="o">...</span>

</pre></div>
</div>
<p><span class="xref myst">↑ haut de page</span></p>
</section>
</section>
<section id="widget-annexe-bouton-de-selection-de-la-langue">
<h2>Widget annexe : bouton de sélection de la langue<a class="headerlink" href="#widget-annexe-bouton-de-selection-de-la-langue" title="Lien permanent vers ce titre">¶</a></h2>
<p>Un widget <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> de sélection de langue doit être créé dès lors que la condition suivante est vérifiée (ce qui ne se produira que si le mode traduction est actif) :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">if</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;authorized languages&#39;</span><span class="p">]:</span>
    <span class="o">...</span>

</pre></div>
</div>
<section id="id8">
<h3>Stockage<a class="headerlink" href="#id8" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le bouton de sélection de la langue est stocké dans la clé <code class="docutils literal notranslate"><span class="pre">'language</span> <span class="pre">widget'</span></code> du dictionnaire interne.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;language widget&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">language_widget</span>

</pre></div>
</div>
<p><em>Où <code class="docutils literal notranslate"><span class="pre">language_widget</span></code> est le widget de sélection de la langue qui vient d’être créé.</em></p>
</section>
<section id="id9">
<h3>Menu<a class="headerlink" href="#id9" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le <code class="docutils literal notranslate"><span class="pre">QMenu</span></code> associé au <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> est stocké dans la clé <code class="docutils literal notranslate"><span class="pre">'language</span> <span class="pre">menu'</span></code> du dictionnaire.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;language menu&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">language_menu</span>

</pre></div>
</div>
<p><em>Où <code class="docutils literal notranslate"><span class="pre">language_menu</span></code> est le <code class="docutils literal notranslate"><span class="pre">QMenu</span></code> qui vient d’être créé.</em></p>
<p>Ce <code class="docutils literal notranslate"><span class="pre">QMenu</span></code> contient une <code class="docutils literal notranslate"><span class="pre">QAction</span></code> par langue disponible. Les <code class="docutils literal notranslate"><span class="pre">QAction</span></code> sont elles-mêmes stockées dans la clé <code class="docutils literal notranslate"><span class="pre">'language</span> <span class="pre">actions'</span></code> du dictionnaire, sous la forme d’une liste.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;language actions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">language_action</span><span class="p">)</span>

</pre></div>
</div>
<p><em>Où <code class="docutils literal notranslate"><span class="pre">language_action</span></code> représente chaque <code class="docutils literal notranslate"><span class="pre">QAction</span></code> venant d’être créée.</em></p>
<p>Les libellés des <code class="docutils literal notranslate"><span class="pre">QAction</span></code> correspondent aux noms abrégés des langues et sont fournis par la liste contenue dans la clé <code class="docutils literal notranslate"><span class="pre">'authorized</span> <span class="pre">languages'</span></code> du dictionnaire :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;authorized languages&#39;</span><span class="p">]</span>

</pre></div>
</div>
<p><em>Pour la définition des actions, cf. <span class="xref myst">Actions contrôlées par les widgets du formulaire</span>.</em></p>
</section>
<section id="rendu">
<h3>Rendu<a class="headerlink" href="#rendu" title="Lien permanent vers ce titre">¶</a></h3>
<p>Au lieu d’une icône, le <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> de sélection de la langue montre un texte correspondant au nom abrégé de la langue sélectionnée. Celui-ci est fourni par la clé <code class="docutils literal notranslate"><span class="pre">'language</span> <span class="pre">value'</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;language value&#39;</span><span class="p">]</span>

</pre></div>
</div>
</section>
<section id="id10">
<h3>Texte d’aide<a class="headerlink" href="#id10" title="Lien permanent vers ce titre">¶</a></h3>
<p>On pourra afficher en infobulle sur le bouton le texte suivant :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="s1">&#39;Sélection de la langue de la métadonnée&#39;</span>

</pre></div>
</div>
</section>
<section id="id11">
<h3>Placement dans la grille<a class="headerlink" href="#id11" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> doit être placé dans le <code class="docutils literal notranslate"><span class="pre">QGridLayout</span></code> associé à la clé parente, obtenu grâce à la méthode <code class="docutils literal notranslate"><span class="pre">plume.rdf.widgetsdict.WidgetsDict.parent_grid</span></code>.</p>
<p>Les paramètres de placement du widget dans la grille - soit les arguments <code class="docutils literal notranslate"><span class="pre">row</span></code>, <code class="docutils literal notranslate"><span class="pre">column</span></code>, <code class="docutils literal notranslate"><span class="pre">rowSpan</span></code> et <code class="docutils literal notranslate"><span class="pre">columnSpan</span></code> de la méthode <code class="docutils literal notranslate"><span class="pre">QGridLayout.addWidget</span></code> - sont donnés par la méthode <code class="docutils literal notranslate"><span class="pre">plume.rdf.widgetsdict.WidgetsDict.widget_placement</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">rowSpan</span><span class="p">,</span> <span class="n">columnSpan</span> <span class="o">=</span> <span class="n">widgetsdict</span><span class="o">.</span><span class="n">widget_placement</span><span class="p">(</span><span class="n">widgetkey</span><span class="p">,</span> <span class="s1">&#39;language widget&#39;</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">widgetsdict</span><span class="o">.</span><span class="n">parent_grid</span><span class="p">(</span><span class="n">widgetkey</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">language_widget</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">rowSpan</span><span class="p">,</span> <span class="n">columnSpan</span><span class="p">)</span>

</pre></div>
</div>
<p><em><code class="docutils literal notranslate"><span class="pre">language_widget</span></code> est le <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> qui vient d’être créé. Le second paramètre de <code class="docutils literal notranslate"><span class="pre">widget_placement</span></code> indique que les coordonnées demandées sont celles du widget annexe de sélection de la langue.</em></p>
</section>
<section id="id12">
<h3>Widget masqué ?<a class="headerlink" href="#id12" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> doit être masqué dès lors que la clé <code class="docutils literal notranslate"><span class="pre">'hidden'</span></code> vaut <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">if</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;hidden&#39;</span><span class="p">]:</span>
    <span class="o">...</span>

</pre></div>
</div>
<p><span class="xref myst">↑ haut de page</span></p>
</section>
</section>
<section id="widget-annexe-bouton-de-selection-de-l-unite">
<h2>Widget annexe : bouton de sélection de l’unité<a class="headerlink" href="#widget-annexe-bouton-de-selection-de-l-unite" title="Lien permanent vers ce titre">¶</a></h2>
<p>Un widget <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> de sélection de l’unité doit être créé dès lors que la condition suivante est vérifiée (ce qui ne se produira qu’en mode édition) :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">if</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;units&#39;</span><span class="p">]:</span>
    <span class="o">...</span>

</pre></div>
</div>
<p>Pour l’heure, de tels widgets ne sont utilisés que pour spécifier les unités à associer aux durées (type RDF <code class="docutils literal notranslate"><span class="pre">xsd:duration</span></code>).</p>
<section id="id13">
<h3>Stockage<a class="headerlink" href="#id13" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le bouton de sélection de l’unité est stocké dans la clé <code class="docutils literal notranslate"><span class="pre">'unit</span> <span class="pre">widget'</span></code> du dictionnaire interne.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;unit widget&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">unit_widget</span>

</pre></div>
</div>
<p><em>Où <code class="docutils literal notranslate"><span class="pre">unit_widget</span></code> est le widget de sélection de l’unité qui vient d’être créé.</em></p>
</section>
<section id="id14">
<h3>Menu<a class="headerlink" href="#id14" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le <code class="docutils literal notranslate"><span class="pre">QMenu</span></code> associé au <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> est stocké dans la clé <code class="docutils literal notranslate"><span class="pre">'unit</span> <span class="pre">menu'</span></code> du dictionnaire.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;unit menu&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">unit_menu</span>

</pre></div>
</div>
<p><em>Où <code class="docutils literal notranslate"><span class="pre">unit_menu</span></code> est le <code class="docutils literal notranslate"><span class="pre">QMenu</span></code> qui vient d’être créé.</em></p>
<p>Ce <code class="docutils literal notranslate"><span class="pre">QMenu</span></code> contient une <code class="docutils literal notranslate"><span class="pre">QAction</span></code> par unité disponible. Les <code class="docutils literal notranslate"><span class="pre">QAction</span></code> sont elles-mêmes stockées dans la clé <code class="docutils literal notranslate"><span class="pre">'unit</span> <span class="pre">actions'</span></code> du dictionnaire, sous la forme d’une liste.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;unit actions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">unit_action</span><span class="p">)</span>

</pre></div>
</div>
<p><em>Où <code class="docutils literal notranslate"><span class="pre">unit_action</span></code> représente chaque <code class="docutils literal notranslate"><span class="pre">QAction</span></code> venant d’être créée.</em></p>
<p>Les libellés des <code class="docutils literal notranslate"><span class="pre">QAction</span></code> correspondent aux noms abrégés des langues et sont fournis par la liste contenue dans la clé <code class="docutils literal notranslate"><span class="pre">'units'</span></code> du dictionnaire :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;units&#39;</span><span class="p">]</span>

</pre></div>
</div>
<p><em>Pour la définition des actions, cf. <span class="xref myst">Actions contrôlées par les widgets du formulaire</span>.</em></p>
</section>
<section id="id15">
<h3>Rendu<a class="headerlink" href="#id15" title="Lien permanent vers ce titre">¶</a></h3>
<p>Au lieu d’une icône, le <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> de sélection de l’unité montre un texte correspondant à l’unité sélectionnée. Celui-ci est fourni par la clé <code class="docutils literal notranslate"><span class="pre">'current</span> <span class="pre">unit'</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;current unit&#39;</span><span class="p">]</span>

</pre></div>
</div>
</section>
<section id="id16">
<h3>Texte d’aide<a class="headerlink" href="#id16" title="Lien permanent vers ce titre">¶</a></h3>
<p>On pourra afficher en infobulle sur le bouton le texte suivant :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="s1">&#39;Sélection de l&#39;</span><span class="n">unité</span> <span class="n">de</span> <span class="n">mesure</span><span class="s1">&#39;</span>

</pre></div>
</div>
</section>
<section id="id17">
<h3>Placement dans la grille<a class="headerlink" href="#id17" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> doit être placé dans le <code class="docutils literal notranslate"><span class="pre">QGridLayout</span></code> associé à la clé parente, obtenu grâce à la méthode <code class="docutils literal notranslate"><span class="pre">plume.rdf.widgetsdict.WidgetsDict.parent_grid</span></code>.</p>
<p>Les paramètres de placement du widget dans la grille - soit les arguments <code class="docutils literal notranslate"><span class="pre">row</span></code>, <code class="docutils literal notranslate"><span class="pre">column</span></code>, <code class="docutils literal notranslate"><span class="pre">rowSpan</span></code> et <code class="docutils literal notranslate"><span class="pre">columnSpan</span></code> de la méthode <code class="docutils literal notranslate"><span class="pre">QGridLayout.addWidget</span></code> - sont donnés par la méthode <code class="docutils literal notranslate"><span class="pre">plume.rdf.widgetsdict.WidgetsDict.widget_placement</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">rowSpan</span><span class="p">,</span> <span class="n">columnSpan</span> <span class="o">=</span> <span class="n">widgetsdict</span><span class="o">.</span><span class="n">widget_placement</span><span class="p">(</span><span class="n">widgetkey</span><span class="p">,</span> <span class="s1">&#39;unit widget&#39;</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">widgetsdict</span><span class="o">.</span><span class="n">parent_grid</span><span class="p">(</span><span class="n">widgetkey</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">unit_widget</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">rowSpan</span><span class="p">,</span> <span class="n">columnSpan</span><span class="p">)</span>

</pre></div>
</div>
<p><em><code class="docutils literal notranslate"><span class="pre">unit_widget</span></code> est le <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> qui vient d’être créé. Le second paramètre de <code class="docutils literal notranslate"><span class="pre">widget_placement</span></code> indique que les coordonnées demandées sont celles du widget annexe de sélection de l’unité.</em></p>
</section>
<section id="id18">
<h3>Widget masqué ?<a class="headerlink" href="#id18" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> doit être masqué dès lors que la clé <code class="docutils literal notranslate"><span class="pre">'hidden'</span></code> vaut <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">if</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;hidden&#39;</span><span class="p">]:</span>
    <span class="o">...</span>

</pre></div>
</div>
<p><span class="xref myst">↑ haut de page</span></p>
</section>
</section>
<section id="widget-annexe-bouton-d-aide-a-la-saisie-des-geometries">
<h2>Widget annexe : bouton d’aide à la saisie des géométries<a class="headerlink" href="#widget-annexe-bouton-d-aide-a-la-saisie-des-geometries" title="Lien permanent vers ce titre">¶</a></h2>
<p>Un widget <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> d’aide à la saisie des géométries doit être créé dès lors que la condition suivante est vérifiée :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">if</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;geo tools&#39;</span><span class="p">]:</span>
    <span class="o">...</span>

</pre></div>
</div>
<p>De tels widgets accompagnent les widgets de saisie appelant des valeurs de type <code class="docutils literal notranslate"><span class="pre">gsp:wktLiteral</span></code>.</p>
<p><em>NB : Contrairement aux autres boutons, les boutons d’aide à la saisie peuvent apparaître en mode lecture. Ils n’offrent alors, bien évidemment, que des fonctionnalités de visualisation.</em></p>
<section id="id19">
<h3>Stockage<a class="headerlink" href="#id19" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le bouton d’aide à la saisie des géométries est stocké dans la clé <code class="docutils literal notranslate"><span class="pre">'geo</span> <span class="pre">widget'</span></code> du dictionnaire interne.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;geo widget&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">geo_widget</span>

</pre></div>
</div>
<p><em>Où <code class="docutils literal notranslate"><span class="pre">geo_widget</span></code> est le widget d’aide à la saisie des géométries qui vient d’être créé.</em></p>
</section>
<section id="id20">
<h3>Menu<a class="headerlink" href="#id20" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le <code class="docutils literal notranslate"><span class="pre">QMenu</span></code> associé au <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> est stocké dans la clé <code class="docutils literal notranslate"><span class="pre">'geo</span> <span class="pre">menu'</span></code> du dictionnaire.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;geo menu&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">geo_menu</span>

</pre></div>
</div>
<p><em>Où <code class="docutils literal notranslate"><span class="pre">geo_menu</span></code> est le <code class="docutils literal notranslate"><span class="pre">QMenu</span></code> qui vient d’être créé.</em></p>
<p>Ce <code class="docutils literal notranslate"><span class="pre">QMenu</span></code> contient une <code class="docutils literal notranslate"><span class="pre">QAction</span></code> par fonction d’assistance disponible. Les <code class="docutils literal notranslate"><span class="pre">QAction</span></code> sont elles-mêmes stockées dans la clé <code class="docutils literal notranslate"><span class="pre">'geo</span> <span class="pre">actions'</span></code> du dictionnaire, sous la forme d’une liste.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;geo actions&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">geo_action</span><span class="p">)</span>

</pre></div>
</div>
<p><em>Où <code class="docutils literal notranslate"><span class="pre">geo_action</span></code> représente chaque <code class="docutils literal notranslate"><span class="pre">QAction</span></code> venant d’être créée.</em></p>
<p>Les actions à faire apparaître dans le menu dépendent des valeurs listées par la clé <code class="docutils literal notranslate"><span class="pre">'geo</span> <span class="pre">tools'</span></code>. Elles sont détaillées par <span class="xref myst">Outils d’aide à la saisie des géométries</span>.</p>
</section>
<section id="icones">
<h3>Icônes<a class="headerlink" href="#icones" title="Lien permanent vers ce titre">¶</a></h3>
<p>L’icône <img alt="geo_button.svg" src="plume/icons/buttons/geo_button.svg" /> à faire apparaître sur le bouton d’aide à la saisie des géométries est fournie par le fichier <span class="xref myst">geo_button.svg</span>. Sa couleur est fixe.</p>
<p>Les actions du menu associé au bouton ont chacune leur icône. Les SVG se trouvent dans le répertoire <span class="xref myst">/plume/icons/buttons/geo</span>, cf. <span class="xref myst">Outils d’aide à la saisie des géométries</span> pour les noms des fichiers.</p>
</section>
<section id="cas-particulier-de-la-visualisation-seule">
<h3>Cas particulier de la visualisation seule<a class="headerlink" href="#cas-particulier-de-la-visualisation-seule" title="Lien permanent vers ce titre">¶</a></h3>
<p>Lorsque la clé <code class="docutils literal notranslate"><span class="pre">'geo</span> <span class="pre">tools'</span></code> vaut exactement <code class="docutils literal notranslate"><span class="pre">['show']</span></code>, c’est-à-dire que la seule fonctionnalité disponible est la visualisation dans le canevas de la géométrie enregistrée dans les métadonnées, il pourrait être envisagé de simplifier le mécanisme :</p>
<ul class="simple">
<li><p>utiliser l’image d’oeil <img alt="show.svg" src="plume/icons/buttons/geo/show.svg" /> comme icône pour le bouton ;</p></li>
<li><p>ne pas créer de menu et simplement lancer la visualisation quand l’utilisateur clique sur le bouton.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">if</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;geo tools&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;show&#39;</span><span class="p">]:</span>
    <span class="o">...</span>

</pre></div>
</div>
</section>
<section id="id21">
<h3>Texte d’aide<a class="headerlink" href="#id21" title="Lien permanent vers ce titre">¶</a></h3>
<p>On pourra afficher en infobulle sur le bouton le texte suivant :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="s1">&#39;Aide à la saisie des géométries&#39;</span>

</pre></div>
</div>
</section>
<section id="id22">
<h3>Placement dans la grille<a class="headerlink" href="#id22" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> doit être placé dans le <code class="docutils literal notranslate"><span class="pre">QGridLayout</span></code> associé à la clé parente, obtenu grâce à la méthode <code class="docutils literal notranslate"><span class="pre">plume.rdf.widgetsdict.WidgetsDict.parent_grid</span></code>.</p>
<p>Les paramètres de placement du widget dans la grille - soit les arguments <code class="docutils literal notranslate"><span class="pre">row</span></code>, <code class="docutils literal notranslate"><span class="pre">column</span></code>, <code class="docutils literal notranslate"><span class="pre">rowSpan</span></code> et <code class="docutils literal notranslate"><span class="pre">columnSpan</span></code> de la méthode <code class="docutils literal notranslate"><span class="pre">QGridLayout.addWidget</span></code> - sont donnés par la méthode <code class="docutils literal notranslate"><span class="pre">plume.rdf.widgetsdict.WidgetsDict.widget_placement</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">rowSpan</span><span class="p">,</span> <span class="n">columnSpan</span> <span class="o">=</span> <span class="n">widgetsdict</span><span class="o">.</span><span class="n">widget_placement</span><span class="p">(</span><span class="n">widgetkey</span><span class="p">,</span> <span class="s1">&#39;geo widget&#39;</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">widgetsdict</span><span class="o">.</span><span class="n">parent_grid</span><span class="p">(</span><span class="n">widgetkey</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">geo_widget</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">rowSpan</span><span class="p">,</span> <span class="n">columnSpan</span><span class="p">)</span>

</pre></div>
</div>
<p><em><code class="docutils literal notranslate"><span class="pre">geo_widget</span></code> est le <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> qui vient d’être créé. Le second paramètre de <code class="docutils literal notranslate"><span class="pre">widget_placement</span></code> indique que les coordonnées demandées sont celles du widget annexe d’aide à la saisie des géométries.</em></p>
</section>
<section id="id23">
<h3>Widget masqué ?<a class="headerlink" href="#id23" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> doit être masqué dès lors que la clé <code class="docutils literal notranslate"><span class="pre">'hidden'</span></code> vaut <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">if</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;hidden&#39;</span><span class="p">]:</span>
    <span class="o">...</span>

</pre></div>
</div>
<p><span class="xref myst">↑ haut de page</span></p>
</section>
</section>
<section id="widget-annexe-bouton-moins">
<h2>Widget annexe : bouton « moins »<a class="headerlink" href="#widget-annexe-bouton-moins" title="Lien permanent vers ce titre">¶</a></h2>
<p>Pour les propriétés admettant des valeurs multiples ou des traductions, des widgets <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> permettent à l’utilisateur de supprimer les valeurs précédemment saisies, à condition qu’il en reste au moins une.</p>
<p>Un tel widget doit être créé dès lors que la condition suivante est vérifiée :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">if</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;has minus button&#39;</span><span class="p">]:</span>
    <span class="o">...</span>

</pre></div>
</div>
<section id="id24">
<h3>Stockage<a class="headerlink" href="#id24" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le boutoin moins est stocké dans la clé <code class="docutils literal notranslate"><span class="pre">'minus</span> <span class="pre">widget'</span></code> du dictionnaire interne.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;minus widget&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">minus_widget</span>

</pre></div>
</div>
<p><em>Où <code class="docutils literal notranslate"><span class="pre">minus_widget</span></code> est le widget bouton moins qui vient d’être créé.</em></p>
</section>
<section id="id25">
<h3>Placement dans la grille<a class="headerlink" href="#id25" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> doit être placé dans le <code class="docutils literal notranslate"><span class="pre">QGridLayout</span></code> associé à la clé parente, obtenu grâce à la méthode <code class="docutils literal notranslate"><span class="pre">plume.rdf.widgetsdict.WidgetsDict.parent_grid</span></code>.</p>
<p>Les paramètres de placement du widget dans la grille - soit les arguments <code class="docutils literal notranslate"><span class="pre">row</span></code>, <code class="docutils literal notranslate"><span class="pre">column</span></code>, <code class="docutils literal notranslate"><span class="pre">rowSpan</span></code> et <code class="docutils literal notranslate"><span class="pre">columnSpan</span></code> de la méthode <code class="docutils literal notranslate"><span class="pre">QGridLayout.addWidget</span></code> - sont donnés par la méthode <code class="docutils literal notranslate"><span class="pre">plume.rdf.widgetsdict.WidgetsDict.widget_placement</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">rowSpan</span><span class="p">,</span> <span class="n">columnSpan</span> <span class="o">=</span> <span class="n">widgetsdict</span><span class="o">.</span><span class="n">widget_placement</span><span class="p">(</span><span class="n">widgetkey</span><span class="p">,</span> <span class="s1">&#39;minus widget&#39;</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">widgetsdict</span><span class="o">.</span><span class="n">parent_grid</span><span class="p">(</span><span class="n">widgetkey</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">minus_widget</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">rowSpan</span><span class="p">,</span> <span class="n">columnSpan</span><span class="p">)</span>

</pre></div>
</div>
<p><em><code class="docutils literal notranslate"><span class="pre">minus_widget</span></code> est le <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> qui vient d’être créé. Le second paramètre de <code class="docutils literal notranslate"><span class="pre">widget_placement</span></code> indique que les coordonnées demandées sont celles du boutoin moins.</em></p>
</section>
<section id="id26">
<h3>Icône<a class="headerlink" href="#id26" title="Lien permanent vers ce titre">¶</a></h3>
<p>L’image <img alt="minus_button.svg" src="plume/icons/buttons/minus_button.svg" /> à utiliser pour un bouton moins est toujours <span class="xref myst">minus_button.svg</span>, mais la couleur dépendra du type de groupe dans lequel se trouve le bouton, soit de la valeur renvoyée par :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="o">.</span><span class="n">group_kind</span><span class="p">(</span><span class="n">widgetkey</span><span class="p">)</span>

</pre></div>
</div>
<p>Comme pour les <code class="docutils literal notranslate"><span class="pre">QGroupBox</span></code> et les boutons plus/boutons de traduction, on pourra utiliser les valeurs par défaut suivantes :</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Type de groupe</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">group_kind(widgetkey)</span></code></p></th>
<th class="head"><p>Couleur</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Groupe de propriétés</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'group</span> <span class="pre">of</span> <span class="pre">properties'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'#958B62'</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Groupe de valeurs</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'group</span> <span class="pre">of</span> <span class="pre">values'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'#5770BE'</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Groupe de traduction</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'translation</span> <span class="pre">group'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'#FF8D7E'</span></code></p></td>
</tr>
</tbody>
</table>
<p><em>NB. En pratique, il n’y a pas de bouton moins dans les groupes de propriétés, donc la couleur associée ne sera jamais utilisée dans ce contexte.</em></p>
<p>Soit <code class="docutils literal notranslate"><span class="pre">color</span></code> la couleur souhaitée pour le bouton et <code class="docutils literal notranslate"><span class="pre">raw_svg</span></code> le contenu du fichier <em>minus_button.svg</em>, on pourra appliquer la couleur avec :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">colored_svg</span> <span class="o">=</span> <span class="n">raw_svg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

</pre></div>
</div>
</section>
<section id="id27">
<h3>Texte d’aide<a class="headerlink" href="#id27" title="Lien permanent vers ce titre">¶</a></h3>
<p>On pourra afficher en infobulle sur le bouton le texte suivant :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="s1">&#39;Supprimer l&#39;</span><span class="n">élément</span><span class="s1">&#39;</span>

</pre></div>
</div>
</section>
<section id="id28">
<h3>Widget masqué ?<a class="headerlink" href="#id28" title="Lien permanent vers ce titre">¶</a></h3>
<p>Comme tous les autres widgets, le <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> doit être masqué dès lors que la clé <code class="docutils literal notranslate"><span class="pre">'hidden'</span></code> vaut <code class="docutils literal notranslate"><span class="pre">True</span></code>. Mais il devra également être masqué si le groupe de traduction ou groupe de valeurs ne contient qu’un élément, soit quand <code class="docutils literal notranslate"><span class="pre">'hide</span> <span class="pre">minus</span> <span class="pre">button'</span></code> vaut <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">if</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;hidden&#39;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;hide minus button&#39;</span><span class="p">]:</span>
    <span class="o">...</span>

</pre></div>
</div>
<p><span class="xref myst">↑ haut de page</span></p>
</section>
</section>
<section id="widget-annexe-bouton-de-calcul">
<h2>Widget annexe : bouton de calcul<a class="headerlink" href="#widget-annexe-bouton-de-calcul" title="Lien permanent vers ce titre">¶</a></h2>
<p>Les boutons de calcul sont une alternative à la saisie manuelle des métadonnées. Ils permettent de calculer leurs valeurs par requête sur le serveur PostgreSQL.</p>
<p>Un tel widget doit être créé dès lors que la condition suivante est vérifiée :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">if</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;has compute button&#39;</span><span class="p">]:</span>
    <span class="o">...</span>

</pre></div>
</div>
<section id="id29">
<h3>Stockage<a class="headerlink" href="#id29" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le boutoin de calcul est stocké dans la clé <code class="docutils literal notranslate"><span class="pre">'compute</span> <span class="pre">widget'</span></code> du dictionnaire interne.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;compute widget&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">compute_widget</span>

</pre></div>
</div>
<p><em>Où <code class="docutils literal notranslate"><span class="pre">compute_widget</span></code> est le widget bouton de calcul qui vient d’être créé.</em></p>
</section>
<section id="id30">
<h3>Placement dans la grille<a class="headerlink" href="#id30" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> doit être placé dans le <code class="docutils literal notranslate"><span class="pre">QGridLayout</span></code> associé à la clé parente, obtenu grâce à la méthode <code class="docutils literal notranslate"><span class="pre">plume.rdf.widgetsdict.WidgetsDict.parent_grid</span></code>.</p>
<p>Les paramètres de placement du widget dans la grille - soit les arguments <code class="docutils literal notranslate"><span class="pre">row</span></code>, <code class="docutils literal notranslate"><span class="pre">column</span></code>, <code class="docutils literal notranslate"><span class="pre">rowSpan</span></code> et <code class="docutils literal notranslate"><span class="pre">columnSpan</span></code> de la méthode <code class="docutils literal notranslate"><span class="pre">QGridLayout.addWidget</span></code> - sont donnés par la méthode <code class="docutils literal notranslate"><span class="pre">plume.rdf.widgetsdict.WidgetsDict.widget_placement</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">rowSpan</span><span class="p">,</span> <span class="n">columnSpan</span> <span class="o">=</span> <span class="n">widgetsdict</span><span class="o">.</span><span class="n">widget_placement</span><span class="p">(</span><span class="n">widgetkey</span><span class="p">,</span> <span class="s1">&#39;compute widget&#39;</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">widgetsdict</span><span class="o">.</span><span class="n">parent_grid</span><span class="p">(</span><span class="n">widgetkey</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">compute_widget</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">rowSpan</span><span class="p">,</span> <span class="n">columnSpan</span><span class="p">)</span>

</pre></div>
</div>
<p><em><code class="docutils literal notranslate"><span class="pre">compute_widget</span></code> est le <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> qui vient d’être créé. Le second paramètre de <code class="docutils literal notranslate"><span class="pre">widget_placement</span></code> indique que les coordonnées demandées sont celles du bouton de calcul.</em></p>
</section>
<section id="id31">
<h3>Icône<a class="headerlink" href="#id31" title="Lien permanent vers ce titre">¶</a></h3>
<p>L’image <img alt="compute_button.svg" src="plume/icons/buttons/compute_button.svg" /> à utiliser pour un bouton de calcul est toujours <span class="xref myst">compute_button.svg</span>.</p>
</section>
<section id="id32">
<h3>Texte d’aide<a class="headerlink" href="#id32" title="Lien permanent vers ce titre">¶</a></h3>
<p>On pourra afficher en infobulle sur le bouton le texte suivant :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="s1">&#39;Calculer côté serveur&#39;</span>

</pre></div>
</div>
</section>
<section id="id33">
<h3>Widget masqué ?<a class="headerlink" href="#id33" title="Lien permanent vers ce titre">¶</a></h3>
<p>Comme tous les autres widgets, le <code class="docutils literal notranslate"><span class="pre">QToolButton</span></code> doit être masqué dès lors que la clé <code class="docutils literal notranslate"><span class="pre">'hidden'</span></code> vaut <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">if</span> <span class="n">widgetsdict</span><span class="p">[</span><span class="n">widgetkey</span><span class="p">][</span><span class="s1">&#39;hidden&#39;</span><span class="p">]:</span>
    <span class="o">...</span>

</pre></div>
</div>
<p><span class="xref myst">↑ haut de page</span></p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Plume</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="usage.html">Usage</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="generation_dictionnaire_widgets.html">Génération du dictionnaire des widgets</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Création d’un nouveau widget</a></li>
<li class="toctree-l2"><a class="reference internal" href="actions_widgets.html">Actions contrôlées par les widgets du formulaire</a></li>
<li class="toctree-l2"><a class="reference internal" href="outils_saisie_geometries.html">Outils d’aide à la saisie des géométries</a></li>
<li class="toctree-l2"><a class="reference internal" href="metadonnees_calculees.html">Métadonnées calculées</a></li>
<li class="toctree-l2"><a class="reference internal" href="actions_generales.html">Actions générales</a></li>
<li class="toctree-l2"><a class="reference internal" href="modeles_de_formulaire.html">Modèles de formulaire</a></li>
<li class="toctree-l2"><a class="reference internal" href="parametres_utilisateur.html">Paramètres utilisateurs</a></li>
<li class="toctree-l2"><a class="reference internal" href="gestion_plume_pg.html">Installation et gestion de l’extension PostgreSQL <em>PlumePg</em></a></li>
<li class="toctree-l2"><a class="reference internal" href="metadonnees_communes.html">Métadonnées communes</a></li>
<li class="toctree-l2"><a class="reference internal" href="conformite_geodcat_ap.html">Conformité au profil GeoDCAT-AP</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../reference/modules.html">Référence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mechanism/mechanism.html">Usage</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="usage.html">Usage</a><ul>
      <li>Previous: <a href="generation_dictionnaire_widgets.html" title="Chapitre précédent">Génération du dictionnaire des widgets</a></li>
      <li>Next: <a href="actions_widgets.html" title="Chapitre suivant">Actions contrôlées par les widgets du formulaire</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Recherche rapide</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, République française.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.4.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/usage/creation_widgets.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>