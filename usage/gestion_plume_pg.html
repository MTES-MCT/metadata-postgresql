
<!DOCTYPE html>

<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Installation et gestion de l’extension PostgreSQL PlumePg &#8212; Documentation Plume 0.3.0-beta</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel="stylesheet">
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94">
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'usage/gestion_plume_pg';</script>
    <link rel="shortcut icon" href="../_static/plume.svg"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="next" title="Métadonnées communes" href="metadonnees_communes.html" />
    <link rel="prev" title="Paramètres utilisateurs" href="parametres_utilisateur.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="fr">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../index.html">

  
  
  
  
  
  
  

  
    <img src="../_static/plume.svg" class="logo__image only-light" alt="Logo image">
    <img src="../_static/plume.svg" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="usage.html">
                        Usage
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../reference/modules.html">
                        Référence
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../mechanism/mechanism.html">
                        Mécanique interne
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../changelog/changelog.html">
                        Notes de version
                      </a>
                    </li>
                
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      
        <div class="navbar-end-item navbar-persistent--container">
          
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Recherche" aria-label="Recherche" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
        </div>
      
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/MTES-MCT/metadata-postgresql" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>


  
  
    <div class="navbar-persistent--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Recherche" aria-label="Recherche" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
    </div>
  

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="usage.html">
                        Usage
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../reference/modules.html">
                        Référence
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../mechanism/mechanism.html">
                        Mécanique interne
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../changelog/changelog.html">
                        Notes de version
                      </a>
                    </li>
                
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/MTES-MCT/metadata-postgresql" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item"><nav class="bd-links" id="bd-docs-nav" aria-label="Section navigation">
  <p class="bd-links__title" role="heading" aria-level="1">
    Section Navigation
  </p>
  <div class="bd-toc-item navbar-nav">
    <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="generation_dictionnaire_widgets.html">Génération du dictionnaire des widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="creation_widgets.html">Création d’un nouveau widget</a></li>
<li class="toctree-l1"><a class="reference internal" href="actions_widgets.html">Actions contrôlées par les widgets du formulaire</a></li>
<li class="toctree-l1"><a class="reference internal" href="outils_saisie_geometries.html">Outils d’aide à la saisie des géométries</a></li>
<li class="toctree-l1"><a class="reference internal" href="metadonnees_calculees.html">Métadonnées calculées</a></li>
<li class="toctree-l1"><a class="reference internal" href="actions_generales.html">Actions générales</a></li>
<li class="toctree-l1"><a class="reference internal" href="modeles_de_formulaire.html">Modèles de formulaire</a></li>
<li class="toctree-l1"><a class="reference internal" href="parametres_utilisateur.html">Paramètres utilisateurs</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Installation et gestion de l’extension PostgreSQL <em>PlumePg</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="metadonnees_communes.html">Métadonnées communes</a></li>
<li class="toctree-l1"><a class="reference internal" href="conformite_geodcat_ap.html">Conformité au profil GeoDCAT-AP</a></li>
</ul>

  </div>
</nav>
    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

  
  <div id="rtd-footer-container"></div>

      </div>
      <main id="main-content" class="bd-main">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            
            <article class="bd-article" role="main">
              
  <section id="installation-et-gestion-de-l-extension-postgresql-plumepg">
<h1>Installation et gestion de l’extension PostgreSQL <em>PlumePg</em><a class="headerlink" href="#installation-et-gestion-de-l-extension-postgresql-plumepg" title="Lien permanent vers ce titre">#</a></h1>
<p>L’extension PostgreSQL <em>PlumePg</em> est un composant optionnel de Plume, qui ouvre la possibilité d’utiliser des <a class="reference internal" href="modeles_de_formulaire.html"><span class="doc std std-doc">modèles de formulaire</span></a> et d”<a class="reference internal" href="#activation-de-l-enregistrement-des-dates"><span class="std std-doc">enregistrer les dates de création et dernière modification des tables</span></a>.</p>
<p><a class="reference internal" href="#compatibilite"><span class="std std-doc">Compatibilité</span></a> • <a class="reference internal" href="#installation"><span class="std std-doc">Installation</span></a> • <a class="reference internal" href="#localisation-des-objets-de-l-extension"><span class="std std-doc">Localisation des objets de l’extension</span></a> • <a class="reference internal" href="#privileges"><span class="std std-doc">Privilèges</span></a> • <a class="reference internal" href="#cohabitation-avec-asgard"><span class="std std-doc">Cohabitation avec <em>Asgard</em></span></a> • <a class="reference internal" href="#mise-a-jour"><span class="std std-doc">Mise à jour</span></a> • <a class="reference internal" href="#desinstallation"><span class="std std-doc">Désinstallation</span></a> • <a class="reference internal" href="#activation-de-l-enregistrement-des-dates"><span class="std std-doc">Activation de l’enregistrement des dates</span></a> • <a class="reference internal" href="#usage-des-modeles-de-formulaires"><span class="std std-doc">Usage des modèles de formulaires</span></a> • <a class="reference internal" href="#sauvegarde-et-restauration-de-la-base"><span class="std std-doc">Sauvegarde et restauration de la base</span></a></p>
<section id="compatibilite">
<h2>Compatibilité<a class="headerlink" href="#compatibilite" title="Lien permanent vers ce titre">#</a></h2>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Compatibilité</p></th>
<th class="head"><p>Remarques</p></th>
<th class="head"><p>Modalités de test</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PostgreSQL &lt;= 9.6</p></td>
<td><p>non</p></td>
<td><p><em>PlumePg</em> requiert la prise en charge des tables partitionnées, introduites par PostgreSQL 10.</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>PostgreSQL 10</p></td>
<td><p>oui</p></td>
<td><p>Nécessite l’extension <code class="docutils literal notranslate"><span class="pre">pgcrypto</span></code>.</p></td>
<td><p>2022.12.07. PostgreSQL 10.12 + PlumePg 0.1.2 + pgcrypto 1.3 + Asgard 1.4.0<a class="footnote-reference brackets" href="#withasgard" id="id1">1</a>.</p></td>
</tr>
<tr class="row-even"><td><p>PostgreSQL 11</p></td>
<td><p>oui</p></td>
<td><p>Nécessite l’extension <code class="docutils literal notranslate"><span class="pre">pgcrypto</span></code>.</p></td>
<td><p>2022.12.07. PostgreSQL 11.9 + PlumePg 0.1.2 + pgcrypto 1.3 + Asgard 1.4.0.</p></td>
</tr>
<tr class="row-odd"><td><p>PostgreSQL 12</p></td>
<td><p>oui</p></td>
<td><p>Nécessite l’extension <code class="docutils literal notranslate"><span class="pre">pgcrypto</span></code>.</p></td>
<td><p>2022.12.07. PostgreSQL 12.4 + PlumePg 0.1.2 + pgcrypto 1.3 + Asgard 1.4.0.</p></td>
</tr>
<tr class="row-even"><td><p>PostgreSQL 13</p></td>
<td><p>oui</p></td>
<td><p></p></td>
<td><p>2022.12.07. PostgreSQL 13.0 + PlumePg 0.1.2 + pgcrypto 1.3<a class="footnote-reference brackets" href="#withcrypto" id="id2">2</a> + Asgard 1.4.0.</p></td>
</tr>
<tr class="row-odd"><td><p>PostgreSQL 14</p></td>
<td><p>oui</p></td>
<td><p></p></td>
<td><p>2022.12.07. PostgreSQL 14.2 + PlumePg 0.1.2 + pgcrypto 1.3 + Asgard 1.4.0.</p></td>
</tr>
<tr class="row-even"><td><p>PostgreSQL 15</p></td>
<td><p>oui</p></td>
<td><p></p></td>
<td><p>2022.12.07. PostgreSQL 15.0 + PlumePg 0.1.2 + pgcrypto 1.3 + Asgard 1.4.0.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Lien permanent vers ce titre">#</a></h2>
<p>Les fichiers d’installation de <em>PlumePg</em> se trouvent dans le dossier <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">postgresql</span></code></span> du Git :</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">plume_pg--x.x.x.sql</span></code> contient le code de la version <code class="docutils literal notranslate"><span class="pre">x.x.x</span></code> de l’extension <em>PlumePg</em>. Celui-ci s’exécute lorsqu’elle est installée sur une base.</p></li>
<li><p><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">plume_pg.control</span></code></span> contient quelques métadonnées et des informations de paramétrage.</p></li>
</ul>
<p>Ces deux fichiers doivent être copiés dans le répertoire des extensions du serveur. Son chemin varie selon l’environnement d’installation, mais il est vraisemblable qu’il soit de la forme <code class="docutils literal notranslate"><span class="pre">C:\Program</span> <span class="pre">Files\PostgreSQL\xx\share\extension</span></code> sous Windows et <code class="docutils literal notranslate"><span class="pre">/usr/share/postgresql/xx/extension</span></code> sous Linux, <code class="docutils literal notranslate"><span class="pre">xx</span></code> étant la version de PostgreSQL.</p>
<p>L’activation de <em>PlumePg</em> sur une base passe par une simple commande <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">EXTENSION</span></code>, qui <strong>doit être exécutée par un super-utilisateur</strong> (création de déclencheurs sur évènement). Pour PostgreSQL 12 et les versions antérieures, il est nécessaire d’installer préalablement l’extension <a class="reference external" href="https://www.postgresql.org/docs/12/pgcrypto.html"><code class="docutils literal notranslate"><span class="pre">pgcrypto</span></code></a>, sur laquelle <em>PlumePg</em> s’appuie pour la génération des UUID<a class="footnote-reference brackets" href="#pgcrypto" id="id3">3</a>. Il s’agit d’une extension standard de PostgreSQL, qui est en principe disponible dans toutes les distributions des versions de PostgreSQL compatibles avec <em>PlumePg</em>.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="n">EXTENSION</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="n">pgcrypto</span><span class="w"> </span><span class="p">;</span>
<span class="k">CREATE</span><span class="w"> </span><span class="n">EXTENSION</span><span class="w"> </span><span class="n">plume_pg</span><span class="w"> </span><span class="p">;</span>
</pre></div>
</div>
<p>Une autre possibilité est d’exécuter la commande <code class="docutils literal notranslate"><span class="pre">CREATE</span> <span class="pre">EXTENSION</span></code> avec l’option <code class="docutils literal notranslate"><span class="pre">CASCADE</span></code>, ce qui installe automatiquement toutes les extensions marquées comme requises dans <code class="docutils literal notranslate"><span class="pre">plume_pg.control</span></code> :</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span><span class="w"> </span><span class="n">EXTENSION</span><span class="w"> </span><span class="n">plume_pg</span><span class="w"> </span><span class="k">CASCADE</span><span class="w"> </span><span class="p">;</span>
</pre></div>
</div>
<p>L’installation est à réaliser par l’administrateur du serveur PostgreSQL. Il n’était pas pertinent que celle-ci puisse se faire via l’interface QGIS de Plume, dont la grande majorité des utilisateurs ne disposera pas des droits nécessaires sur le serveur PostgreSQL. Par contre, <a class="reference external" href="https://snum.scenari-community.org/Asgard/Documentation/#SEC_AsgardManager"><em>AsgardManager</em></a> propose cette fonctionnalité, via son menu <a class="reference external" href="https://snum.scenari-community.org/Asgard/Documentation/#SEC_MenuGestionBase"><code class="docutils literal notranslate"><span class="pre">Gestion</span> <span class="pre">de</span> <span class="pre">la</span> <span class="pre">base</span></code></a>.</p>
</section>
<section id="localisation-des-objets-de-l-extension">
<h2>Localisation des objets de l’extension<a class="headerlink" href="#localisation-des-objets-de-l-extension" title="Lien permanent vers ce titre">#</a></h2>
<p>Tous les objets de l’extension sont créés dans le schéma <code class="docutils literal notranslate"><span class="pre">z_plume</span></code>.</p>
</section>
<section id="privileges">
<h2>Privilèges<a class="headerlink" href="#privileges" title="Lien permanent vers ce titre">#</a></h2>
<p>Les données du schéma <code class="docutils literal notranslate"><span class="pre">z_plume</span></code> alimentent le plugin QGIS et doivent dès lors être accessibles à tous ses utilisateurs. Pour simplifier la gestion des droits, le pseudo rôle <code class="docutils literal notranslate"><span class="pre">public</span></code> reçoit automatiquement les privilèges suivants lorsque <em>PlumePg</em> est installée sur une base :</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">USAGE</span></code> sur le schéma <code class="docutils literal notranslate"><span class="pre">z_plume</span></code> ;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SELECT</span></code> sur toutes les tables et vues de ce schéma.</p></li>
</ul>
<p>Des droits étendus sont conférés sur la table <code class="docutils literal notranslate"><span class="pre">z_plume.stamp_timestamp</span></code>, permettant au propriétaire d’une table - et seulement à lui - de modifier manuellement les dates enregistrées pour cette table. <em>NB : Ce contrôle d’accès est réalisé par un déclencheur et non des politiques de sécurité niveau ligne, car l’usage de ces dernières par les extensions provoque actuellement des erreurs en cas de sauvegarde/restauration.</em></p>
</section>
<section id="cohabitation-avec-asgard">
<h2>Cohabitation avec <em>Asgard</em><a class="headerlink" href="#cohabitation-avec-asgard" title="Lien permanent vers ce titre">#</a></h2>
<p>Il n’y a pas de lien fonctionnel direct entre <em>PlumePg</em> et l’extension <a class="reference external" href="https://snum.scenari-community.org/Asgard/Documentation/"><em>Asgard</em></a>, outil créé dans le cadre du GT PostGIS pour faciliter la gestion des droits.</p>
<p>Si l’extension <em>PlumePg</em> est installée sur une base disposant déjà d”<em>Asgard</em>, <code class="docutils literal notranslate"><span class="pre">g_admin</span></code> sera automatiquement désigné comme <em>producteur</em> du schéma et <code class="docutils literal notranslate"><span class="pre">public</span></code> en sera fait <em>lecteur</em><a class="footnote-reference brackets" href="#asgard-version" id="id4">4</a>. Il s’agit juste de faciliter le travail de l’administrateur, cette opération ne crée aucune adhérence durable. Il est ensuite tout à fait possible, sans que cela ne pose de problème particulier, y compris lors des futures montées de version de <em>PlumePg</em> :</p>
<ul class="simple">
<li><p>de choisir d’autres rôles comme <em>producteur</em>, <em>éditeur</em> et <em>lecteur</em> de <code class="docutils literal notranslate"><span class="pre">z_plume</span></code>. <em>Attention tout de même à sélectionner un lecteur dont sont membres les rôles de connexion de tous les utilisateurs potentiels du plugin QGIS !</em></p></li>
<li><p>de déréférencer le schéma <code class="docutils literal notranslate"><span class="pre">z_plume</span></code> pour gérer ses droits hors d”<em>Asgard</em> ;</p></li>
<li><p>de désinstaller <em>Asgard</em>.</p></li>
</ul>
</section>
<section id="mise-a-jour">
<h2>Mise à jour<a class="headerlink" href="#mise-a-jour" title="Lien permanent vers ce titre">#</a></h2>
<p>Comme pour l’installation, les fichiers de mise à jour sont disponibles dans le dossier <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">postgresql</span></code></span> du Git :</p>
<ul class="simple">
<li><p>un ou plusieurs fichiers <code class="docutils literal notranslate"><span class="pre">plume_pg--x.x.x--y.y.y.sql</span></code>, qui sont des scripts de passage de la version <code class="docutils literal notranslate"><span class="pre">x.x.x</span></code> à la version <code class="docutils literal notranslate"><span class="pre">y.y.y</span></code>. Plusieurs de ces scripts peuvent s’exécuter à la suite lors d’une mise à jour (<code class="docutils literal notranslate"><span class="pre">plume_pg--x.x.x--x1.x1.x1.sql</span></code>, <code class="docutils literal notranslate"><span class="pre">plume_pg--x1.x1.x1--x2.x2.x2.sql</span></code>, …, <code class="docutils literal notranslate"><span class="pre">plume_pg--xn.xn.xn--y.y.y.sql</span></code>).</p></li>
<li><p>un nouveau fichier <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">plume_pg.control</span></code></span> remplaçant le précédent. Ce fichier change en principe peu d’une version à l’autre, si ce n’est pour la <em>version par défaut</em> qu’il spécifie, qui sera toujours la version la plus récente.</p></li>
<li><p>un fichier <code class="docutils literal notranslate"><span class="pre">plume_pg--y.y.y.sql</span></code> contenant le code complet de la version <code class="docutils literal notranslate"><span class="pre">y.y.y</span></code> de l’extension <em>PlumePg</em>. Celui-ci n’est pas utilisé lors de la mise à jour, mais pourra servir par la suite, notamment en cas de sauvegarde/restauration de la base, ou pour l’installation de <em>PlumePg</em> sur une nouvelle base.</p></li>
</ul>
<p>Cf. <a class="reference internal" href="#installation"><span class="std std-doc">Installation</span></a> pour l’emplacement du répertoire où ces fichiers doivent être copiés.</p>
<p>Sur toutes les bases où <em>PlumePg</em> était installée, on exécutera ensuite :</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span><span class="w"> </span><span class="n">EXTENSION</span><span class="w"> </span><span class="n">plume_pg</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">TO</span><span class="w"> </span><span class="s1">&#39;y.y.y&#39;</span><span class="w"> </span><span class="p">;</span>
</pre></div>
</div>
<p>Sauf à cibler une version qui ne serait pas la dernière, il est souvent plus simple de ne pas spécifier le numéro de version et d’effectuer la mise à jour sur la version par défaut définie par <code class="docutils literal notranslate"><span class="pre">plume_pg.control</span></code> :</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span><span class="w"> </span><span class="n">EXTENSION</span><span class="w"> </span><span class="n">plume_pg</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="desinstallation">
<h2>Désinstallation<a class="headerlink" href="#desinstallation" title="Lien permanent vers ce titre">#</a></h2>
<p>Pour désinstaller <em>PlumePg</em> d’une base :</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">DROP</span><span class="w"> </span><span class="n">EXTENSION</span><span class="w"> </span><span class="n">plume_pg</span><span class="w"> </span><span class="p">;</span>
</pre></div>
</div>
<p>La désinstallation entraîne la perte définitive de tous les <a class="reference internal" href="modeles_de_formulaire.html"><span class="doc std std-doc">modèles de formulaire</span></a>.</p>
<p><em>NB. Si le schéma <code class="docutils literal notranslate"><span class="pre">z_plume</span></code> existait avant l’installation de l’extension, il ne sera pas marqué comme dépendant de l’extension et ne sera donc pas supprimé en cas de désinstallation. Tout son contenu le sera, par contre.</em></p>
</section>
<section id="activation-de-l-enregistrement-des-dates">
<h2>Activation de l’enregistrement des dates<a class="headerlink" href="#activation-de-l-enregistrement-des-dates" title="Lien permanent vers ce titre">#</a></h2>
<p><em>PlumePg</em> propose un système pour garder une trace des dates de création et dernière modification des tables. Assez rudimentaire, il ne prend en charge que les tables simples, ignorant notamment les vues et vues matérialisées.</p>
<p>Les dates sont enregistrées dans la table <code class="docutils literal notranslate"><span class="pre">z_plume.stamp_timestamp</span></code>. Son champ <code class="docutils literal notranslate"><span class="pre">relid</span></code> contient les identifiants PostgreSQL des tables (OID), son champ <code class="docutils literal notranslate"><span class="pre">created</span></code> les dates de création et son champ <code class="docutils literal notranslate"><span class="pre">modified</span></code> les dates de dernière modification.</p>
<p>À l’installation de <em>PlumePg</em>, les fonctionnalités d’enregistrement des dates de création et dernière modification des tables sont inactives. La table <code class="docutils literal notranslate"><span class="pre">z_plume.stamp_timestamp</span></code> est et restera vide sans intervention de l’administrateur.</p>
<p>Dès lors que l’administrateur le souhaite, deux stratégies peuvent être mises en oeuvre : soit enregistrer automatiquement les dates pour toutes les tables dès leur création, soit enregistrer les dates de dernière modification uniquement pour certaines tables explicitement désignées.</p>
<section id="suivi-automatique-integral">
<h3>Suivi automatique intégral<a class="headerlink" href="#suivi-automatique-integral" title="Lien permanent vers ce titre">#</a></h3>
<p>Pour mettre en place le suivi intégral, on activera les trois déclencheurs sur évènement de <em>PlumePg</em>.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span><span class="w"> </span><span class="n">EVENT</span><span class="w"> </span><span class="k">TRIGGER</span><span class="w"> </span><span class="n">plume_stamp_table_creation</span><span class="w"> </span><span class="n">ENABLE</span><span class="w"> </span><span class="p">;</span>
<span class="k">ALTER</span><span class="w"> </span><span class="n">EVENT</span><span class="w"> </span><span class="k">TRIGGER</span><span class="w"> </span><span class="n">plume_stamp_table_modification</span><span class="w"> </span><span class="n">ENABLE</span><span class="w"> </span><span class="p">;</span>
<span class="k">ALTER</span><span class="w"> </span><span class="n">EVENT</span><span class="w"> </span><span class="k">TRIGGER</span><span class="w"> </span><span class="n">plume_stamp_table_drop</span><span class="w"> </span><span class="n">ENABLE</span><span class="w"> </span><span class="p">;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">plume_stamp_table_creation</span></code> se charge d’enregistrer les dates de création des tables dans <code class="docutils literal notranslate"><span class="pre">z_plume.stamp_timestamp</span></code> et crée sur les nouvelles tables les déclencheurs <code class="docutils literal notranslate"><span class="pre">plume_stamp_data_edit</span></code> qui assureront le suivi des modifications des données.</p>
<p><code class="docutils literal notranslate"><span class="pre">plume_stamp_table_modification</span></code> met à jour la date de dernière modification en cas de modification de structure des tables (commandes <code class="docutils literal notranslate"><span class="pre">ALTER</span> <span class="pre">TABLE</span></code>).</p>
<p><code class="docutils literal notranslate"><span class="pre">plume_stamp_table_drop</span></code> efface de <code class="docutils literal notranslate"><span class="pre">z_plume.stamp_timestamp</span></code> les lignes correspondant aux tables qui viennent d’être supprimées.</p>
</section>
<section id="suivi-au-cas-par-cas">
<h3>Suivi au cas par cas<a class="headerlink" href="#suivi-au-cas-par-cas" title="Lien permanent vers ce titre">#</a></h3>
<p>Pour n’activer le suivi des modifications que sur certaines tables explicitement désignées, il faut laisser inactif le déclencheur sur évènement <code class="docutils literal notranslate"><span class="pre">plume_stamp_table_creation</span></code>.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span><span class="w"> </span><span class="n">EVENT</span><span class="w"> </span><span class="k">TRIGGER</span><span class="w"> </span><span class="n">plume_stamp_table_modification</span><span class="w"> </span><span class="n">ENABLE</span><span class="w"> </span><span class="p">;</span>
<span class="k">ALTER</span><span class="w"> </span><span class="n">EVENT</span><span class="w"> </span><span class="k">TRIGGER</span><span class="w"> </span><span class="n">plume_stamp_table_drop</span><span class="w"> </span><span class="n">ENABLE</span><span class="w"> </span><span class="p">;</span>
</pre></div>
</div>
<p>Il faut alors lancer la fonction <code class="docutils literal notranslate"><span class="pre">z_plume.stamp_create_trigger</span></code> sur une table pour commencer à enregistrer ses dates de modification, tant les modifications des données que celles de la structure.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">z_plume</span><span class="p">.</span><span class="n">stamp_create_trigger</span><span class="p">(</span><span class="s1">&#39;schema_name.table_name&#39;</span><span class="p">::</span><span class="n">regclass</span><span class="p">)</span><span class="w"> </span><span class="p">;</span>
</pre></div>
</div>
<p>La fonction renvoie <code class="docutils literal notranslate"><span class="pre">True</span></code> si la création du déclencheur a fonctionné, <code class="docutils literal notranslate"><span class="pre">False</span></code> sinon. Elle doit être exécutée par le propriétaire de la table.</p>
<p>Une alternative consisterait à activer <code class="docutils literal notranslate"><span class="pre">plume_stamp_table_creation</span></code> en supprimant le suivi des modifications sur certaines tables qui ne le justifient pas :</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">DROP</span><span class="w"> </span><span class="k">TRIGGER</span><span class="w"> </span><span class="n">plume_stamp_data_edit</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">schema_name</span><span class="p">.</span><span class="k">table_name</span><span class="w"> </span><span class="p">;</span>
<span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">z_plume</span><span class="p">.</span><span class="n">stamp_timestamp</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">relid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;schema_name.table_name&#39;</span><span class="p">::</span><span class="n">regclass</span><span class="w"> </span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="integration-directe-dans-les-metadonnees">
<h3>Intégration directe dans les métadonnées<a class="headerlink" href="#integration-directe-dans-les-metadonnees" title="Lien permanent vers ce titre">#</a></h3>
<p>Pour ne pas trop affecter les performances et laisser au producteur de la donnée la maîtrise de ces informations, les dates ne sont pas immédiatement mises à jour dans les fiches de métadonnées, seulement dans la table <code class="docutils literal notranslate"><span class="pre">stamp_timestamp</span></code>, qui peut être considérée comme un espace de stockage temporaire. Le plugin QGIS permet de les importer facilement lors de l’édition d’une fiche, soit à la demande en cliquant sur un bouton, soit automatiquement à l’ouverture de la fiche (cf. <a class="reference internal" href="metadonnees_calculees.html"><span class="doc std std-doc">Métadonnées calculées</span></a>).</p>
<p>Il est toutefois possible de forcer l’actualisation au fil de l’eau de la date de dernière modification en activant le déclencheur <code class="docutils literal notranslate"><span class="pre">stamp_timestamp_to_metadata</span></code> défini sur la table <code class="docutils literal notranslate"><span class="pre">stamp_timestamp</span></code>.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">z_plume</span><span class="p">.</span><span class="n">stamp_timestamp</span><span class="w"> </span><span class="n">ENABLE</span><span class="w"> </span><span class="k">TRIGGER</span><span class="w"> </span><span class="n">stamp_timestamp_to_metadata</span><span class="w"> </span><span class="p">;</span>
</pre></div>
</div>
<p>Ceci ne vaudra que pour les tables qui ont déjà une fiche de métadonnées, raison pour laquelle les dates de création ne sont pas concernées.</p>
<p>Lorsque ce déclencheur est actif, il n’y a aucun intérêt à utiliser les fonctionnalités de calcul pour la date de dernière modification (catégorie <code class="docutils literal notranslate"><span class="pre">dct:modified</span></code>).</p>
</section>
<section id="observations-sur-la-gestion-des-suppressions-de-tables">
<h3>Observations sur la gestion des suppressions de tables<a class="headerlink" href="#observations-sur-la-gestion-des-suppressions-de-tables" title="Lien permanent vers ce titre">#</a></h3>
<p>Quelle que soit la stratégie choisie, il n’est pas indispensable d’activer le déclencheur sur évènement <code class="docutils literal notranslate"><span class="pre">plume_stamp_table_drop</span></code>. À défaut, il faudra éliminer régulièrement les lignes de <code class="docutils literal notranslate"><span class="pre">z_plume.stamp_timestamp</span></code> correspondant aux tables qui n’existent plus avec la fonction <code class="docutils literal notranslate"><span class="pre">z_plume.stamp_clean_timestamp</span></code>.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">z_plume</span><span class="p">.</span><span class="n">stamp_clean_timestamp</span><span class="p">()</span><span class="w"> </span><span class="p">;</span>
</pre></div>
</div>
<p>La fonction renvoie le nombre de lignes supprimées de <code class="docutils literal notranslate"><span class="pre">z_plume.stamp_timestamp</span></code>. Elle doit être exécutée par le propriétaire de <code class="docutils literal notranslate"><span class="pre">z_plume.stamp_timestamp</span></code>.</p>
<p>À noter qu’il n’est généralement pas intéressant de conserver des lignes mortes dans la <code class="docutils literal notranslate"><span class="pre">z_plume.stamp_clean_timestamp</span></code>, sauf à disposer d’un moyen pour retrouver le nom de la table à partir de son identifiant (OID) désormais non référencé dans <code class="docutils literal notranslate"><span class="pre">pg_class</span></code>.</p>
</section>
<section id="fausses-modifications">
<h3>Fausses modifications<a class="headerlink" href="#fausses-modifications" title="Lien permanent vers ce titre">#</a></h3>
<p>Le mécanisme mis en place par <em>PLumePg</em> peut donner lieu à des faux positifs, soit des cas où la date de dernière modification sera actualisée sans que la table ni son contenu n’aient véritablement changé.</p>
<p>Le déclencheur sur évènement <code class="docutils literal notranslate"><span class="pre">plume_stamp_table_modification</span></code> est ainsi activé par toutes les commandes <code class="docutils literal notranslate"><span class="pre">ALTER</span> <span class="pre">TABLE</span></code>, y compris celles qui n’affectent pas réellement la table, comme un changement de nom qui conserve le nom d’origine.</p>
<p>Les déclencheurs <code class="docutils literal notranslate"><span class="pre">plume_stamp_data_edit</span></code> sont activés par toutes les commandes <code class="docutils literal notranslate"><span class="pre">INSERT</span></code>, <code class="docutils literal notranslate"><span class="pre">UPDATE</span></code>, <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> et <code class="docutils literal notranslate"><span class="pre">TRUNCATE</span></code>, y compris celles qui - sans pour autant échouer - n’ont aucun effet. Par exemple une commande <code class="docutils literal notranslate"><span class="pre">UPDATE</span></code> ou <code class="docutils literal notranslate"><span class="pre">DELETE</span></code> telle qu’aucune ligne ne remplit la condition de sa clause <code class="docutils literal notranslate"><span class="pre">WHERE</span></code>. Il paraissait préférable d’avoir recours à des déclencheurs <code class="docutils literal notranslate"><span class="pre">ON</span> <span class="pre">EACH</span> <span class="pre">STATEMENT</span></code> qu’à des déclencheurs <code class="docutils literal notranslate"><span class="pre">ON</span> <span class="pre">EACH</span> <span class="pre">ROW</span></code>, certes moins susceptibles de retenir des fausses modifications mais susceptibles d’allonger considérablement le temps d’exécution des requêtes.</p>
</section>
</section>
<section id="usage-des-modeles-de-formulaires">
<h2>Usage des modèles de formulaires<a class="headerlink" href="#usage-des-modeles-de-formulaires" title="Lien permanent vers ce titre">#</a></h2>
<p>Cf. <a class="reference internal" href="modeles_de_formulaire.html"><span class="doc std std-doc">Modèles de formulaires</span></a>.</p>
</section>
<section id="sauvegarde-et-restauration-de-la-base">
<h2>Sauvegarde et restauration de la base<a class="headerlink" href="#sauvegarde-et-restauration-de-la-base" title="Lien permanent vers ce titre">#</a></h2>
<p>Pour que les données de <em>PlumePg</em> soient préservées lors de la restauration, notamment les <a class="reference internal" href="modeles_de_formulaire.html"><span class="doc std std-doc">modèles de formulaire</span></a>, il est essentiel de <strong>ne pas chercher à réinstaller manuellement l’extension sur la base de restauration</strong>. Tout est automatique. On veillera seulement à ce que :</p>
<ul class="simple">
<li><p>les fichiers d’installation de <em>PlumePg</em> soient disponibles dans le répertoire des extensions du serveur de restauration (cf. <a class="reference internal" href="#installation"><span class="std std-doc">Installation</span></a> pour l’emplacement de ce répertoire) ;</p></li>
<li><p>la version par défaut de <em>PlumePg</em> sur le serveur de restauration soit identique à celle qui est effectivement installée sur la base à sauvegarder.</p></li>
</ul>
<p>Cette <em>version par défaut</em> apparaît dans le fichier <code class="docutils literal notranslate"><span class="pre">plume_pg.control</span></code> et peut également être consultée avec la requête (à exécuter sur n’importe quelle base du serveur de restauration) :</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">default_version</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">pg_available_extensions</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;plume_pg&#39;</span><span class="w"> </span><span class="p">;</span>
</pre></div>
</div>
<p>Pour connaître la version installée sur la base à sauvergarder, on pourra par exemple exécuter sur celle-ci :</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">installed_version</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">pg_available_extensions</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;plume_pg&#39;</span><span class="w"> </span><span class="p">;</span>
</pre></div>
</div>
<p>De manière très classique, le processus de restauration est le suivant :</p>
<ol class="arabic simple">
<li><p>Sauvegarder la base originale, par la méthode habituelle.</p></li>
<li><p>Créer une base vierge.</p></li>
<li><p>Lancer la restauration sur cette base vierge, par la méthode habituelle.</p></li>
</ol>
<section id="considerations-specifiques-au-mecanisme-d-enregistrement-des-dates">
<h3>Considérations spécifiques au mécanisme d’enregistrement des dates<a class="headerlink" href="#considerations-specifiques-au-mecanisme-d-enregistrement-des-dates" title="Lien permanent vers ce titre">#</a></h3>
<p>En l’état actuel, au contraire des informations relatives aux modèles, les dates stockées dans la table <code class="docutils literal notranslate"><span class="pre">z_plume.stamp_timestamp</span></code> ne sont pas conservées en cas de sauvegarde et restauration de la base. Il faudra qu’elles aient été préalablement intégrées aux fiches de métadonnées pour ne pas être <strong>perdues</strong>. Cette intégration s’effectue en principe lors de l’édition des fiches de métadonnées avec le plugin QGIS, sous réserve d’avoir activé la <a class="reference internal" href="metadonnees_calculees.html"><span class="doc std std-doc">fonctionnalité de calcul</span></a> pour les catégories <code class="docutils literal notranslate"><span class="pre">dct:created</span></code> et <code class="docutils literal notranslate"><span class="pre">dct:modified</span></code>. Pour les dates de dernières modifications, elle peut aussi être réalisée automatiquement côté serveur en activant le déclencheur prévu à cette fin - cf. <a class="reference internal" href="#integration-directe-dans-les-metadonnees"><span class="std std-doc">Intégration directe dans les métadonnées</span></a>.</p>
<p>Les déclencheurs et déclencheurs sur évènement retrouvent leur état initial après la restauration et <strong>devront donc être réactivés manuellement</strong> d’autant que de besoin - cf. <a class="reference internal" href="#activation-de-l-enregistrement-des-dates"><span class="std std-doc">Activation de l’enregistrement des dates</span></a>. Il n’est pas nécessaire de chercher à recréer les déclencheurs <code class="docutils literal notranslate"><span class="pre">plume_stamp_data_edit</span></code> sur les tables, ils sont pour leur part restaurés.</p>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="withasgard"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>L’extension PostgreSQL <em>Asgard</em> n’est en aucune façon requise pour utiliser Plume et <em>PlumePg</em>. Les tests faisant intervenir <em>Asgard</em> s’assure simplement que, dans le cas où les deux extensions sont présentes, <em>Asgard</em> gère correctement les droits sur les objets de <em>PlumePg</em>. Cf. <a class="reference internal" href="#cohabitation-avec-asgard"><span class="std std-doc">Cohabitation avec <em>Asgard</em></span></a></p>
</dd>
<dt class="label" id="withcrypto"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Les tests sont réalisés avec le fichier de contrôle standard de <em>PlumePg</em>, unique pour toutes les versions de PostgreSQL et qui requiert <code class="docutils literal notranslate"><span class="pre">pgcrypto</span></code>. Il est donc vérifié que celui-ci peut être installé pour toutes les versions, y compris PostgreSQL 13, 14 et 15, pour lesquelles <em>PlumePg</em> n’utilise ensuite aucune de ses fonctionnalités.</p>
</dd>
<dt class="label" id="pgcrypto"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p><em>PlumePg</em> se sert de la fonction <code class="docutils literal notranslate"><span class="pre">gen_random_uuid()</span></code> pour générer des UUID. Pour les versions 10, 11, et 12 de PostgreSQL, elle est fournie par l’extension <em>pgcrypto</em>. Pour les versions 13 et supérieures, cette fonction est incluse dans le coeur de PostgreSQL (cf. <a class="reference external" href="https://www.postgresql.org/docs/13/functions-uuid.html">documentation de PostgreSQL</a>), installer <code class="docutils literal notranslate"><span class="pre">pgcrypto</span></code> n’est donc en principe plus nécessaire et il pourrait être pertinent de modifier le fichier <code class="docutils literal notranslate"><span class="pre">plume_pg.control</span></code> pour retirer <code class="docutils literal notranslate"><span class="pre">pgcrypto</span></code> de la liste des extensions requises.</p>
</dd>
<dt class="label" id="asgard-version"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p>Sous réserve d’utiliser une version d’Asgard supérieure ou égale à la 1.3.2. Dans les versions antérieures, les schémas créés par les extensions n’étaient pas automatiquement référencés.</p>
</dd>
</dl>
</section>
</section>
</section>


            </article>
            
            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="parametres_utilisateur.html" title="précédent page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">précédent</p>
          <p class="prev-next-title">Paramètres utilisateurs</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="metadonnees_communes.html" title="suivant page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">suivant</p>
      <p class="prev-next-title">Métadonnées communes</p>
  </div>
  <i class="fa-solid fa-angle-right"></i>
  </a>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#compatibilite">
   Compatibilité
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#installation">
   Installation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#localisation-des-objets-de-l-extension">
   Localisation des objets de l’extension
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#privileges">
   Privilèges
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cohabitation-avec-asgard">
   Cohabitation avec
   <em>
    Asgard
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mise-a-jour">
   Mise à jour
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#desinstallation">
   Désinstallation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#activation-de-l-enregistrement-des-dates">
   Activation de l’enregistrement des dates
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#suivi-automatique-integral">
     Suivi automatique intégral
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#suivi-au-cas-par-cas">
     Suivi au cas par cas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#integration-directe-dans-les-metadonnees">
     Intégration directe dans les métadonnées
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#observations-sur-la-gestion-des-suppressions-de-tables">
     Observations sur la gestion des suppressions de tables
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fausses-modifications">
     Fausses modifications
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#usage-des-modeles-de-formulaires">
   Usage des modèles de formulaires
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sauvegarde-et-restauration-de-la-base">
   Sauvegarde et restauration de la base
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#considerations-specifiques-au-mecanisme-d-enregistrement-des-dates">
     Considérations spécifiques au mécanisme d’enregistrement des dates
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
</div>

<div class="toc-item">
  
<div id="searchbox"></div>
</div>

<div class="toc-item">
  
</div>

<div class="toc-item">
  
<div class="tocsection sourcelink">
    <a href="../_sources/usage/gestion_plume_pg.md.txt">
        <i class="fa-solid fa-file-lines"></i> Montrer le code source
    </a>
</div>

</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2022, République française.<br>

</p>

  </div>
  
  <div class="footer-item">
    <p class="theme-version">
    Built with the
    <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">
        PyData Sphinx Theme
    </a>
    0.12.0.
</p>
  </div>
  
  <div class="footer-item">
    
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>

  </div>
  
</div>
  </footer>
  </body>
</html>