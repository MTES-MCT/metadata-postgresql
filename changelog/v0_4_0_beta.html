
<!DOCTYPE html>

<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Version 0.4.0 bêta (en cours de développement) &#8212; Documentation Plume 0.3.0-beta</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    <link rel="shortcut icon" href="../_static/plume.svg"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="prev" title="Version mineure 0.3.2 bêta" href="v0_3_2_beta.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="fr">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/plume.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../usage/usage.html">
  Usage
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../reference/modules.html">
  Référence
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../mechanism/mechanism.html">
  Mécanique interne
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="changelog.html">
  Notes de version
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/MTES-MCT/metadata-postgresql" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="v0_3_1_beta.html">
   Version mineure 0.3.1 bêta
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="v0_3_2_beta.html">
   Version mineure 0.3.2 bêta
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Version 0.4.0 bêta (
   <em>
    en cours de développement
   </em>
   )
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#verrouillage-de-l-affichage-sur-la-fiche-courante">
   Verrouillage de l’affichage sur la fiche courante
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#confirmation-a-la-sortie-du-mode-edition">
   Confirmation à la sortie du mode édition
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#affichage-des-metadonnees-de-la-couche-selectionnee-au-lancement-de-plume">
   Affichage des métadonnées de la couche sélectionnée au lancement de Plume
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plumepg-v0-1-0">
   PlumePg v0.1.0
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parametrage-du-calcul-automatique-des-metadonnees">
     Paramétrage du calcul automatique des métadonnées
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#desactivation-d-un-modele">
     Désactivation d’un modèle
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#amelioration-de-la-gestion-des-metadonnees-en-lecture-seule">
   Amélioration de la gestion des métadonnées en lecture seule
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gestion-des-dependances">
   Gestion des dépendances
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="version-0-4-0-beta-en-cours-de-developpement">
<h1>Version 0.4.0 bêta (<em>en cours de développement</em>)<a class="headerlink" href="#version-0-4-0-beta-en-cours-de-developpement" title="Lien permanent vers ce titre">#</a></h1>
<p><em>Date de publication : à venir.</em></p>
<p><em>Sur GitHub : à venir.</em></p>
<p>La version 0.4 apporte notamment plusieurs petites évolutions fonctionnelles visant à fluidifier et sécuriser la navigation.</p>
<section id="verrouillage-de-l-affichage-sur-la-fiche-courante">
<h2>Verrouillage de l’affichage sur la fiche courante<a class="headerlink" href="#verrouillage-de-l-affichage-sur-la-fiche-courante" title="Lien permanent vers ce titre">#</a></h2>
<p>La version 0.4 ajoute à la barre d’outil de Plume un bouton en forme de cadenas qui permet de verrouiller l’affichage sur la fiche de métadonnées courante.</p>
<p>En mode lecture, ce bouton est désactivé par défaut. Quand l’utilisateur sélectionne une nouvelle couche PostgreSQL dans l’explorateur ou le panneau, les métadonnées de cette couche s’affichent dans le panneau de Plume. Lorsqu’il sélectionne une couche dont le fournisseur n’est pas un serveur PostgreSQL, Plume revient à son écran d’accueil.</p>
<p>Si l’utilisateur actionne le bouton de verrouillage, la fiche de métadonnées courante restera affichée dans le panneau de Plume quelles que soient les manipulations réalisées par l’utilisateur dans l’explorateur et le panneau des couches.</p>
<p>En mode édition, ce bouton est activé par défaut et ne peut pas être désactivé. Ceci permet d’éviter à l’utilisateur de perdre accidentellement ses modifications à cause d’un clic malencontreux sur une autre couche.</p>
<p><em>Références : <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/36">issue #36</a>, <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/41">issue #41</a>, <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/47">issue #47</a>.</em></p>
</section>
<section id="confirmation-a-la-sortie-du-mode-edition">
<h2>Confirmation à la sortie du mode édition<a class="headerlink" href="#confirmation-a-la-sortie-du-mode-edition" title="Lien permanent vers ce titre">#</a></h2>
<p>Lorsque l’utilisateur quitte le mode édition sans avoir préalablement sauvegardé ses modifications, Plume lui demande maintenant une confirmation. Un paramètre utilisateur permet de supprimer cette étape.</p>
<p><em>Références : <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/46">issue #46</a>.</em></p>
</section>
<section id="affichage-des-metadonnees-de-la-couche-selectionnee-au-lancement-de-plume">
<h2>Affichage des métadonnées de la couche sélectionnée au lancement de Plume<a class="headerlink" href="#affichage-des-metadonnees-de-la-couche-selectionnee-au-lancement-de-plume" title="Lien permanent vers ce titre">#</a></h2>
<p>Si l’utilisateur sélectionne une couche PostgreSQL dans l’explorateur ou le panneau des couches <em>puis</em> lance Plume, les métadonnées de cette couche sont maintenant immédiatement affichées. Auparavant, seules les couches sélectionnées après le lancement de Plume étaient prises en compte.</p>
<p><em>Références : <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/38">issue #38</a>.</em></p>
</section>
<section id="plumepg-v0-1-0">
<h2>PlumePg v0.1.0<a class="headerlink" href="#plumepg-v0-1-0" title="Lien permanent vers ce titre">#</a></h2>
<p><strong>Une mise à jour de l’extension PostgreSQL PlumePg sera nécessaire</strong> pour continuer à utiliser les modèles personnalisés avec la version 0.4 de Plume.</p>
<p>La version 0.1.0 de PlumePg apporte plusieurs petites évolutions fonctionnelles.</p>
<section id="parametrage-du-calcul-automatique-des-metadonnees">
<h3>Paramétrage du calcul automatique des métadonnées<a class="headerlink" href="#parametrage-du-calcul-automatique-des-metadonnees" title="Lien permanent vers ce titre">#</a></h3>
<p>Les champs <code class="docutils literal notranslate"><span class="pre">compute</span></code> des tables <code class="docutils literal notranslate"><span class="pre">meta_categorie</span></code> et <code class="docutils literal notranslate"><span class="pre">meta_template_categories</span></code> admettent maintenant deux nouvelles valeurs, <code class="docutils literal notranslate"><span class="pre">empty</span></code> et <code class="docutils literal notranslate"><span class="pre">new</span></code>. Comme <code class="docutils literal notranslate"><span class="pre">auto</span></code>, ces mots-clés signalent à Plume que la métadonnée doit être calculée automatiquement à partir des informations disponibles sur le serveur PostgreSQL lors du chargement de la fiche de métadonnées. Toutefois, ils posent des conditions à cette action :</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">empty</span></code> indique que le calcul automatique doit avoir lieu si et seulement si aucune valeur n’est encore renseignée pour la métadonnée considérée.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">new</span></code> signale que le calcul doit s’exécuter si et seulement si la fiche de métadonnées est vierge.</p></li>
</ul>
<p>Les tables <code class="docutils literal notranslate"><span class="pre">meta_categorie</span></code> et <code class="docutils literal notranslate"><span class="pre">meta_template_categories</span></code>, ainsi que la vue <code class="docutils literal notranslate"><span class="pre">meta_template_categories_full</span></code> présentent maintenant un champ supplémentaire de type <code class="docutils literal notranslate"><span class="pre">jsonb</span></code> qui permet de paramétrer la méthode de calcul des métadonnées définie pour la catégorie, lorsque la méthode le prévoit.</p>
</section>
<section id="desactivation-d-un-modele">
<h3>Désactivation d’un modèle<a class="headerlink" href="#desactivation-d-un-modele" title="Lien permanent vers ce titre">#</a></h3>
<p>La table <code class="docutils literal notranslate"><span class="pre">meta_template</span></code> présente désormais un champ supplémentaire, <code class="docutils literal notranslate"><span class="pre">enabled</span></code>, qui peut être mis à <code class="docutils literal notranslate"><span class="pre">False</span></code> pour empêcher qu’un modèle soit proposé aux utilisateurs du plugin QGIS. Ce mécanisme pourra notamment être mis à profit pendant la consitution des modèles, afin de ne pas mettre à disposition des utilisateurs des modèles non finalisés.</p>
</section>
</section>
<section id="amelioration-de-la-gestion-des-metadonnees-en-lecture-seule">
<h2>Amélioration de la gestion des métadonnées en lecture seule<a class="headerlink" href="#amelioration-de-la-gestion-des-metadonnees-en-lecture-seule" title="Lien permanent vers ce titre">#</a></h2>
<p>La version 0.4 assure que les métadonnées en lecture seule<a class="footnote-reference brackets" href="#isreadonly" id="id1">1</a> en mode édition ne sont plus accompagnées d’aucun bouton permettant d’en altérer la valeur. Les groupes de valeurs en lecture seule n’ont plus de bouton plus.</p>
<p>La lecture seule est désormais une caractéristique héritable. Ainsi, si le modèle indique par exemple que la métadonnée <code class="docutils literal notranslate"><span class="pre">dct:temporal</span></code> est en lecture seule, <code class="docutils literal notranslate"><span class="pre">dct:temporal</span> <span class="pre">/</span> <span class="pre">dcat:startDate</span></code> le sera également même si ce n’est pas explicitement spécifié dans le modèle.</p>
<p><em>Référence : <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/48">issue #48</a>.</em></p>
</section>
<section id="gestion-des-dependances">
<h2>Gestion des dépendances<a class="headerlink" href="#gestion-des-dependances" title="Lien permanent vers ce titre">#</a></h2>
<p>La version 0.4 met en place un nouveau système de gestion des bibliothèques python requises pour le fonctionnement de Plume, qui permettra de les mettre à jour en parallèle des mises à jour de Plume et allège leur processus d’installation.</p>
<p>Elles restent incorporées dans le plugin (installateurs dans le répertoire <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/tree/main/plume/bibli_install">/plume/bibli_install</a>), mais sont maintenant référencées par un fichier de dépendances <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/tree/main/plume/requirements.txt"><code class="docutils literal notranslate"><span class="pre">/plume/requirements.txt</span></code></a>.</p>
<p>En pratique, l’utilisateur pourra constater les changements suivants :</p>
<ul class="simple">
<li><p>Plume mettra systématiquement à jour les dépendances au premier lancement du plugin suivant chaque mise à jour de Plume, c’est-à-dire lorsqu’il clique pour la première fois sur l’icône de Plume dans la barre d’outils. Jusqu’à présent Plume se contentait de tester la disponibilité de la bibliothèque RDFLib et, à défaut, l’installait avec ses dépendances sans contrôler en aucune façon les versions.</p></li>
<li><p>Le processus commence toujours par une tentative de mise à jour de <code class="docutils literal notranslate"><span class="pre">pip</span></code>, l’utilitaire de gestion des bibliothèques python. Cette étape se manifeste par l’ouverture d’une première fenêtre de commandes. Elle échouera nécessairement en l’absence de connexion internet ou si la connexion nécessite de passer par un proxy, sans que cela ne prête à conséquence pour la suite. À noter qu’au lieu de retenter cinq fois d’établir la connexion avec un délai / <em>timeout</em> de 10 secondes, Plume ne réalise plus qu’un seul essai avec un délai de 5 secondes, ce qui accélère considérablement l’opération.</p></li>
<li><p>Plume installe ou met ensuite à jour les dépendances elles-mêmes, selon les spécifications du fichier <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/blob/main/plume/requirements.txt"><code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code></a>. Cette étape ouvre désormais une unique fenêtre de commande dans laquelle apparaîtront toutes les opérations réalisées, et non plus une fenêtre par bibliothèque comme auparavant.</p></li>
</ul>
<p><em>Référence : <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/51">issue #51</a>, <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/53">issue #53</a>.</em></p>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="isreadonly"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Une catégorie peut être déclarée comme étant « en lecture seule » (non éditable) par un modèle de fiche défini avec <em>PlumePg</em>. On indiquera <code class="docutils literal notranslate"><span class="pre">True</span></code> dans le champ <code class="docutils literal notranslate"><span class="pre">is_read_only</span></code> de la table <code class="docutils literal notranslate"><span class="pre">z_plume.meta_template_categories</span></code> pour le modèle et la catégorie considérés.</p>
</dd>
</dl>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="v0_3_2_beta.html" title="précédent page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">précédent</p>
            <p class="prev-next-title">Version mineure 0.3.2 bêta</p>
        </div>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022, République française.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>