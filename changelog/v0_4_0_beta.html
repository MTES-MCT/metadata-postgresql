
<!DOCTYPE html>

<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Version 0.4.0 bêta &#8212; Documentation Plume 0.3.0-beta</title>
  <script>
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1e1de1a1873e13ef5536" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1e1de1a1873e13ef5536" rel="stylesheet">

  
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/6.1.2/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1e1de1a1873e13ef5536">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'changelog/v0_4_0_beta';</script>
    <link rel="shortcut icon" href="../_static/plume.svg"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
    <link rel="next" title="Version mineure 0.4.1 bêta" href="v0_4_1_beta.html" />
    <link rel="prev" title="Version mineure 0.3.2 bêta" href="v0_3_2_beta.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="fr">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../index.html">

  
  
  
  
  
  
  

  
    <img src="../_static/plume.svg" class="logo__image only-light" alt="Logo image">
    <img src="../_static/plume.svg" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                <li class="nav-item">
                    <a class="nav-link" href="../usage/usage.html">
                        Usage
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../reference/modules.html">
                        Référence
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../mechanism/mechanism.html">
                        Mécanique interne
                    </a>
                </li>
                

                <li class="nav-item current active">
                    <a class="nav-link" href="changelog.html">
                        Notes de version
                    </a>
                </li>
                
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      <div class="navbar-end-item navbar-end__search-button-container">
        
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Recherche" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
      </div>
      
      <div class="navbar-end-item">
        <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" data-toggle="tooltip">
    <a class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="fa-regular fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/MTES-MCT/metadata-postgresql" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>


  
  <div class="search-button-container--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Recherche" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
  </div>

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                <li class="nav-item">
                    <a class="nav-link" href="../usage/usage.html">
                        Usage
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../reference/modules.html">
                        Référence
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="../mechanism/mechanism.html">
                        Mécanique interne
                    </a>
                </li>
                

                <li class="nav-item current active">
                    <a class="nav-link" href="changelog.html">
                        Notes de version
                    </a>
                </li>
                
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" data-toggle="tooltip">
    <a class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="fa-regular fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/MTES-MCT/metadata-postgresql" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item"><nav class="bd-links" id="bd-docs-nav" aria-label="Section navigation">
  <p class="bd-links__title" role="heading" aria-level="1">
    Section Navigation
  </p>
  <div class="bd-toc-item navbar-nav">
    <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="v0_3_1_beta.html">Version mineure 0.3.1 bêta</a></li>
<li class="toctree-l1"><a class="reference internal" href="v0_3_2_beta.html">Version mineure 0.3.2 bêta</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Version 0.4.0 bêta</a></li>
<li class="toctree-l1"><a class="reference internal" href="v0_4_1_beta.html">Version mineure 0.4.1 bêta</a></li>
<li class="toctree-l1"><a class="reference internal" href="v0_5_0_beta.html">Version mineure 0.5.0 bêta</a></li>
<li class="toctree-l1"><a class="reference internal" href="v0_6_0_beta.html">Version mineure 0.6.0 bêta (en cours de développement)</a></li>
</ul>

  </div>
</nav>
    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

      </div>
      <main class="bd-main">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            
            <article class="bd-article" role="main">
              
  <section id="version-0-4-0-beta">
<h1>Version 0.4.0 bêta<a class="headerlink" href="#version-0-4-0-beta" title="Lien permanent vers ce titre">#</a></h1>
<p><em>Date de publication : 10 juin 2022.</em></p>
<p><em>Sur GitHub : <a class="github reference external" href="https://github.com/MTES-MCT/metadata-postgresql/releases/tag/v0.4-beta">MTES-MCT/metadata-postgresql</a>.</em></p>
<p>Plume 0.4 bêta met en service les fonctionnalités de calcul de métadonnées côté serveur. Elle apporte également diverses petites évolutions fonctionnelles visant notamment à fluidifier et sécuriser la navigation.</p>
<p>Il est fortement recommandé de mettre à jour l’extension PostgreSQL PlumePg en parallèle (version 0.1.0). La version 0.0.1 n’est plus reconnue par cette nouvelle version de Plume.</p>
<section id="calcul-des-metadonnees-cote-serveur">
<h2>Calcul des métadonnées côté serveur<a class="headerlink" href="#calcul-des-metadonnees-cote-serveur" title="Lien permanent vers ce titre">#</a></h2>
<p>Plume permet désormais de générer des métadonnées à partir d’informations disponibles côté serveur :</p>
<ul class="simple">
<li><p>soit automatiquement à l’ouverture de la fiche de métadonnées ;</p></li>
<li><p>soit à la demande de l’utilisateur, lorsque celui-ci clique sur le bouton <img alt="compute_button.svg" src="../_images/compute_button.svg" /> placé à droite du champ de saisie dans le formulaire.</p></li>
</ul>
<p>L’activation des fonctionnalités de calcul est contrôlée par les modèles. Elle n’est évidemment possible que pour les catégories pour lesquelles une méthode de calcul est d’ores-et-déjà définie dans Plume (essentiellement, il s’agit une requête SQL à envoyer au serveur). Certaines méthodes de calcul ne sont disponible que si l’extension PlumePg est installée sur la base PostgreSQL cible.</p>
<p>Dans cette version, cela concerne :</p>
<ul class="simple">
<li><p>le titre et la description du jeu de données, qui peuvent être extraits du descriptif PostgreSQL de la table à l’aide d’une expression régulière ;</p></li>
<li><p>les dates de création et de dernière modification, si elles ont été <a class="reference internal" href="#enregistrement-des-dates-de-creation-et-derniere-modification-des-tables"><span class="std std-doc">enregistrées</span></a> ;</p></li>
<li><p>les référentiels de coordonnées déclarés pour les champs de la table.</p></li>
</ul>
<p>Cf. <a class="reference internal" href="../usage/metadonnees_calculees.html"><span class="doc std std-doc">Métadonnées calculées</span></a> pour plus de précisions.</p>
<p><em>Réferences : <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/23">issue #23</a> (prérequis : <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/23">issue #22</a>), <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/42">issue #42</a>.</em></p>
</section>
<section id="amelioration-de-la-navigation">
<h2>Amélioration de la navigation<a class="headerlink" href="#amelioration-de-la-navigation" title="Lien permanent vers ce titre">#</a></h2>
<section id="verrouillage-de-l-affichage-sur-la-fiche-courante">
<h3>Verrouillage de l’affichage sur la fiche courante<a class="headerlink" href="#verrouillage-de-l-affichage-sur-la-fiche-courante" title="Lien permanent vers ce titre">#</a></h3>
<p>Plume 0.4 bêta ajoute à la barre d’outil de Plume un bouton en forme de cadenas <img alt="verrou.svg" src="../_images/verrou.svg" /> qui permet de verrouiller l’affichage sur la fiche de métadonnées courante.</p>
<p>En mode lecture, ce bouton est désactivé par défaut. Quand l’utilisateur sélectionne une nouvelle couche PostgreSQL dans l’explorateur ou le panneau, les métadonnées de cette couche s’affichent dans le panneau de Plume. Lorsqu’il sélectionne une couche dont le fournisseur n’est pas un serveur PostgreSQL, Plume revient à son écran d’accueil.</p>
<p>Si l’utilisateur actionne le bouton de verrouillage, la fiche de métadonnées courante restera affichée dans le panneau de Plume quelles que soient les manipulations réalisées par l’utilisateur dans l’explorateur et le panneau des couches.</p>
<p>En mode édition, ce bouton est activé par défaut et ne peut pas être désactivé. Ceci permet d’éviter à l’utilisateur de perdre accidentellement ses modifications à cause d’un clic malencontreux sur une autre couche.</p>
<p><em>Références : <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/36">issue #36</a>, <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/41">issue #41</a>, <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/47">issue #47</a>.</em></p>
</section>
<section id="confirmation-a-la-sortie-du-mode-edition">
<h3>Confirmation à la sortie du mode édition<a class="headerlink" href="#confirmation-a-la-sortie-du-mode-edition" title="Lien permanent vers ce titre">#</a></h3>
<p>Lorsque l’utilisateur quitte le mode édition sans avoir préalablement sauvegardé ses modifications, Plume lui demande maintenant une confirmation. Un paramètre utilisateur permet de supprimer cette étape.</p>
<p><em>Références : <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/46">issue #46</a>.</em></p>
</section>
<section id="affichage-des-metadonnees-de-la-couche-selectionnee-au-lancement-de-plume">
<h3>Affichage des métadonnées de la couche sélectionnée au lancement de Plume<a class="headerlink" href="#affichage-des-metadonnees-de-la-couche-selectionnee-au-lancement-de-plume" title="Lien permanent vers ce titre">#</a></h3>
<p>Si l’utilisateur sélectionne une couche PostgreSQL dans l’explorateur ou le panneau des couches <em>puis</em> lance Plume, les métadonnées de cette couche sont maintenant immédiatement affichées. Auparavant, seules les couches sélectionnées après le lancement de Plume étaient prises en compte.</p>
<p><em>Références : <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/38">issue #38</a>.</em></p>
</section>
</section>
<section id="plumepg-v0-1-0">
<h2>PlumePg v0.1.0<a class="headerlink" href="#plumepg-v0-1-0" title="Lien permanent vers ce titre">#</a></h2>
<p><strong>Une mise à jour de l’extension PostgreSQL PlumePg sera nécessaire</strong> pour continuer à utiliser les modèles personnalisés avec la version 0.4 de Plume.</p>
<p>La version 0.1.0 de PlumePg apporte deux évolutions fonctionnelles notables :</p>
<ul class="simple">
<li><p>un paramétrage plus fin des <a class="reference internal" href="../usage/metadonnees_calculees.html"><span class="doc std std-doc">fonctionnalités de calcul des métadonnées</span></a> par les modèles ;</p></li>
<li><p>un mécanisme pour enregistrer les dates de création et de dernière modification des tables, en vue de les intégrer aux fiches de métadonnées.</p></li>
</ul>
<section id="parametrage-du-calcul-automatique-des-metadonnees">
<h3>Paramétrage du calcul automatique des métadonnées<a class="headerlink" href="#parametrage-du-calcul-automatique-des-metadonnees" title="Lien permanent vers ce titre">#</a></h3>
<p>Les champs <code class="docutils literal notranslate"><span class="pre">compute</span></code> des tables <code class="docutils literal notranslate"><span class="pre">meta_categorie</span></code> et <code class="docutils literal notranslate"><span class="pre">meta_template_categories</span></code> admettent maintenant deux nouvelles valeurs, <code class="docutils literal notranslate"><span class="pre">empty</span></code> et <code class="docutils literal notranslate"><span class="pre">new</span></code>. Comme <code class="docutils literal notranslate"><span class="pre">auto</span></code>, ces mots-clés signalent à Plume que la métadonnée doit être calculée automatiquement à partir des informations disponibles sur le serveur PostgreSQL lors du chargement de la fiche de métadonnées. Toutefois, ils posent des conditions à cette action :</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">empty</span></code> indique que le calcul automatique doit avoir lieu si et seulement si aucune valeur n’est encore renseignée pour la métadonnée considérée.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">new</span></code> signale que le calcul doit s’exécuter si et seulement si la fiche de métadonnées est vierge.</p></li>
</ul>
<p>Les tables <code class="docutils literal notranslate"><span class="pre">meta_categorie</span></code> et <code class="docutils literal notranslate"><span class="pre">meta_template_categories</span></code>, ainsi que la vue <code class="docutils literal notranslate"><span class="pre">meta_template_categories_full</span></code> présentent maintenant un champ supplémentaire <code class="docutils literal notranslate"><span class="pre">compute_params</span></code> de type <code class="docutils literal notranslate"><span class="pre">jsonb</span></code> qui permet de paramétrer la méthode de calcul des métadonnées définie pour la catégorie, lorsque la méthode le prévoit.</p>
</section>
<section id="desactivation-d-un-modele">
<h3>Désactivation d’un modèle<a class="headerlink" href="#desactivation-d-un-modele" title="Lien permanent vers ce titre">#</a></h3>
<p>La table <code class="docutils literal notranslate"><span class="pre">meta_template</span></code> présente désormais un champ supplémentaire, <code class="docutils literal notranslate"><span class="pre">enabled</span></code>, qui peut être mis à <code class="docutils literal notranslate"><span class="pre">False</span></code> pour empêcher qu’un modèle soit proposé aux utilisateurs du plugin QGIS. Ce mécanisme pourra notamment être mis à profit pendant la consitution des modèles, afin de ne pas mettre à disposition des utilisateurs des modèles non finalisés.</p>
</section>
<section id="enregistrement-des-dates-de-creation-et-derniere-modification-des-tables">
<h3>Enregistrement des dates de création et dernière modification des tables<a class="headerlink" href="#enregistrement-des-dates-de-creation-et-derniere-modification-des-tables" title="Lien permanent vers ce titre">#</a></h3>
<p>PlumePg propose désormais un mécanisme, entièrement optionnel, pour enregistrer automatiquement les dates de création et dernière modification des tables. Cf. <a class="reference internal" href="../usage/gestion_plume_pg.html#activation-de-l-enregistrement-des-dates"><span class="std std-doc">Installation et gestion de l’extension PostgreSQL <em>PlumePg</em></span></a>.</p>
<p><em>Références : <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/60">issue #60</a>.</em></p>
</section>
<section id="acces-aux-donnees-de-l-extension">
<h3>Accès aux données de l’extension<a class="headerlink" href="#acces-aux-donnees-de-l-extension" title="Lien permanent vers ce titre">#</a></h3>
<p>Pour faciliter la gestion des droits sur l’extension, PlumePg confère désormais à tous les utilisateurs un accès en lecture à toutes ses données, via le pseudo-rôle <code class="docutils literal notranslate"><span class="pre">public</span></code>. Cf. <a class="reference internal" href="../usage/gestion_plume_pg.html#privileges"><span class="std std-doc">Installation et gestion de l’extension PostgreSQL <em>PlumePg</em></span></a>.</p>
</section>
</section>
<section id="amelioration-de-la-gestion-des-metadonnees-en-lecture-seule">
<h2>Amélioration de la gestion des métadonnées en lecture seule<a class="headerlink" href="#amelioration-de-la-gestion-des-metadonnees-en-lecture-seule" title="Lien permanent vers ce titre">#</a></h2>
<p>Plume 0.4 bêta assure que les métadonnées en lecture seule<a class="footnote-reference brackets" href="#isreadonly" id="id1">1</a> en mode édition ne sont plus accompagnées d’aucun bouton permettant d’en altérer la valeur. Les groupes de valeurs en lecture seule n’ont plus de bouton plus.</p>
<p>La lecture seule est désormais une caractéristique héritable. Ainsi, si le modèle indique par exemple que la métadonnée <code class="docutils literal notranslate"><span class="pre">dct:temporal</span></code> est en lecture seule, <code class="docutils literal notranslate"><span class="pre">dct:temporal</span> <span class="pre">/</span> <span class="pre">dcat:startDate</span></code> le sera également même si ce n’est pas explicitement spécifié dans le modèle.</p>
<p><em>Référence : <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/48">issue #48</a>.</em></p>
</section>
<section id="gestion-des-dependances-python">
<h2>Gestion des dépendances Python<a class="headerlink" href="#gestion-des-dependances-python" title="Lien permanent vers ce titre">#</a></h2>
<p>Plume 0.4 bêta met en place un nouveau système de gestion des bibliothèques Python requises pour le fonctionnement de Plume, qui permettra de les mettre à jour en parallèle des mises à jour de Plume et allège leur processus d’installation.</p>
<p>Elles restent incorporées dans le plugin (installateurs dans le répertoire <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/tree/main/plume/bibli_install">/plume/bibli_install</a>), mais sont maintenant référencées par un fichier de dépendances <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/tree/main/plume/requirements.txt"><code class="docutils literal notranslate"><span class="pre">/plume/requirements.txt</span></code></a>.</p>
<p>En pratique, l’utilisateur pourra constater les changements suivants :</p>
<ul class="simple">
<li><p>Plume mettra systématiquement à jour les dépendances au premier lancement du plugin suivant chaque mise à jour de Plume, c’est-à-dire lorsqu’il clique pour la première fois sur l’icône de Plume dans la barre d’outils. Jusqu’à présent Plume se contentait de tester la disponibilité de la bibliothèque RDFLib et, à défaut, l’installait avec ses dépendances sans contrôler en aucune façon les versions.</p></li>
<li><p>Le processus commence toujours par une tentative de mise à jour de <code class="docutils literal notranslate"><span class="pre">pip</span></code>, l’utilitaire de gestion des bibliothèques python. Cette étape se manifeste par l’ouverture d’une première fenêtre de commandes. Elle échouera nécessairement en l’absence de connexion internet ou si la connexion nécessite de passer par un proxy, sans que cela ne prête à conséquence pour la suite. À noter qu’au lieu de retenter cinq fois d’établir la connexion avec un délai / <em>timeout</em> de 10 secondes, Plume ne réalise plus qu’un seul essai avec un délai de 5 secondes, ce qui accélère considérablement l’opération.</p></li>
<li><p>Plume installe ou met ensuite à jour les dépendances elles-mêmes, selon les spécifications du fichier <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/blob/main/plume/requirements.txt"><code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code></a>. Cette étape ouvre désormais une unique fenêtre de commande dans laquelle apparaîtront toutes les opérations réalisées, et non plus une fenêtre par bibliothèque comme auparavant.</p></li>
</ul>
<p><em>Référence : <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/51">issue #51</a>, <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/53">issue #53</a>.</em></p>
</section>
<section id="modification-du-modele-de-metadonnees">
<h2>Modification du modèle de métadonnées<a class="headerlink" href="#modification-du-modele-de-metadonnees" title="Lien permanent vers ce titre">#</a></h2>
<p>La métadonnée commune <code class="docutils literal notranslate"><span class="pre">dct:subject</span></code> (<em>catégorie thématique</em>) est supprimée. Cette métadonnée était un ajout de GeoDCAT-AP par rapport à DCAT et DCAT-AP. La nomenclature ISO qu’elle utilisait est désormais l’un des thésaurus utilisables pour la propriété <code class="docutils literal notranslate"><span class="pre">dcat:theme</span></code> (thème), qui devient donc l’unique métadonnée relative aux thèmes catégorisés. Si elle est présente dans des métadonnées importées, elle sera désormais automatiquement transformée en <code class="docutils literal notranslate"><span class="pre">dcat:theme</span></code>.</p>
<p>La version 0.1.0 de PlumePg fait disparaître en conséquence cette métadonnée de la liste des catégories communes disponibles, ce qui provoquera en cascade sa suppression des modèles. S’il y a lieu de la remplacer (par exemple par <code class="docutils literal notranslate"><span class="pre">dcat:theme</span></code>), cette opération devra être réalisée manuellement.</p>
</section>
<section id="anomalies-et-divers">
<h2>Anomalies et divers<a class="headerlink" href="#anomalies-et-divers" title="Lien permanent vers ce titre">#</a></h2>
<p>Les fonctionnalités de visualisation des métadonnées géométriques prennent désormais en charge tous les types géométriques dont QGIS sait interpréter la représentation WKT. <em>Références : <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/34">issue #34</a>.</em></p>
<p>Il est désormais possible de sélectionner et copier du texte dans les fiches de métadonnées ouvertes en mode lecture. <em>Références : <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/56">issue #56</a>.</em></p>
<p>Le nom du modèle courant est dorénavant explicitement affiché dans la barre d’outils de Plume. <em>Références : <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/55">issue #55</a>.</em></p>
<p>Il est maintenant possible de spécifier via un modèle qu’une catégorie commune prenant pour valeur des dates simples utilise à la place des dates avec heures, ou réciproquement. Jusqu’ici, les modèles pouvaient seulement changer le type de valeur pour les catégories locales.</p>
<p>Complément sur la traduction anglaise des textes de l’interface du plugin QGIS, hors éléments inclus dans les fiches de métadonnées. <em>Référence : <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/50">issue #50</a>.</em></p>
<p>Plume vérifie désormais la compatibilité des versions de Plume et PlumePg avant de tenter d’utiliser cette dernière pour importer des modèles. En cas de non compatibilité, seuls les modèles locaux sont disponibles, comme dans le cas où PlumePg n’est pas installée sur la base. <em>Référence : <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/49">issue #49</a>.</em></p>
<p>Correction d’une anomalie qui empêchait d’importer des fiches de métadonnées depuis certains CSW, notamment celui de GéoIDE. <em>Référence : <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/65">issue #65</a>.</em></p>
<p>Correction du point de moissonnage pour le CSW de GéoIDE : <code class="docutils literal notranslate"><span class="pre">http://ogc.geo-ide.developpement-durable.gouv.fr/csw/harvestable-dataset</span></code> est remplacé par <code class="docutils literal notranslate"><span class="pre">http://ogc.geo-ide.developpement-durable.gouv.fr/csw/dataset-harvestable</span></code>. Les points de moissonnages pré-configurés ne sont désormais plus référencés dans le <code class="docutils literal notranslate"><span class="pre">QGIS3.ini</span></code>, afin de faciliter leur maintenance. Plus généralement tous les paramètres de configuration qui n’ont pas vocation à être personnalisés par l’utilisateur ou selon l’environnement sortent du fichier <code class="docutils literal notranslate"><span class="pre">QGIS3.ini</span></code>. Ils sont maintenant définis par un fichier interne au code de Plume, <code class="docutils literal notranslate"><span class="pre">config.py</span></code>.</p>
<p>Consolidation de la gestion des connexions au serveur PostgreSQL et des erreurs induites par les suppressions d’objets pendant l’édition des métadonnées, tant dans QGIS que côté serveur. <em>Référence : <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/59">issue #59</a> et <a class="reference external" href="https://github.com/MTES-MCT/metadata-postgresql/issues/63">issue #63</a>.</em></p>
<p>Les champs supprimés n’apparaissent plus dans l’onglet <em>Champs</em> des fiches de métadonnées, ce qui - en plus de n’être pas pertinent - provoquait une erreur lors de l’enregistrement.</p>
<p>Correction d’une anomalie (ou du moins révision d’un comportement intentionnel mais sous optimal) qui faisait apparaître des blocs vides dans fiches de métadonnées dans les conditions suivantes :</p>
<ul class="simple">
<li><p>En mode lecture.</p></li>
<li><p>Catégorie autorisant à la fois des valeurs issues d’un thésaurus et des valeurs décrites manuellement.</p></li>
<li><p>Toutes les propriétés servant à la description manuelle sont hors modèle, seules les valeurs issues d’un thésaurus sont donc supposées être affichées.</p></li>
<li><p>La description manuelle avait servi pour une valeur (au moins une propriété préalablement renseignée). C’est le bloc correspond à cette valeur qui apparaissait vide au lieu de ne pas apparaître du tout.</p></li>
</ul>
<p>Correction d’une coquille qui affectait la suppression de sources de vocabulaire contrôlé via les modèles.</p>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="isreadonly"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Une catégorie peut être déclarée comme étant « en lecture seule » (non éditable) par un modèle de fiche défini avec <em>PlumePg</em>, en indiquant <code class="docutils literal notranslate"><span class="pre">True</span></code> dans le champ <code class="docutils literal notranslate"><span class="pre">is_read_only</span></code> de la table <code class="docutils literal notranslate"><span class="pre">z_plume.meta_template_categories</span></code> pour le modèle et la catégorie considérés.</p>
</dd>
</dl>
</section>
</section>


            </article>
            
            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="v0_3_2_beta.html" title="précédent page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">précédent</p>
          <p class="prev-next-title">Version mineure 0.3.2 bêta</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="v0_4_1_beta.html" title="suivant page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">suivant</p>
      <p class="prev-next-title">Version mineure 0.4.1 bêta</p>
  </div>
  <i class="fa-solid fa-angle-right"></i>
  </a>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#calcul-des-metadonnees-cote-serveur">
   Calcul des métadonnées côté serveur
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#amelioration-de-la-navigation">
   Amélioration de la navigation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#verrouillage-de-l-affichage-sur-la-fiche-courante">
     Verrouillage de l’affichage sur la fiche courante
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#confirmation-a-la-sortie-du-mode-edition">
     Confirmation à la sortie du mode édition
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#affichage-des-metadonnees-de-la-couche-selectionnee-au-lancement-de-plume">
     Affichage des métadonnées de la couche sélectionnée au lancement de Plume
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plumepg-v0-1-0">
   PlumePg v0.1.0
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#parametrage-du-calcul-automatique-des-metadonnees">
     Paramétrage du calcul automatique des métadonnées
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#desactivation-d-un-modele">
     Désactivation d’un modèle
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#enregistrement-des-dates-de-creation-et-derniere-modification-des-tables">
     Enregistrement des dates de création et dernière modification des tables
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#acces-aux-donnees-de-l-extension">
     Accès aux données de l’extension
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#amelioration-de-la-gestion-des-metadonnees-en-lecture-seule">
   Amélioration de la gestion des métadonnées en lecture seule
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gestion-des-dependances-python">
   Gestion des dépendances Python
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modification-du-modele-de-metadonnees">
   Modification du modèle de métadonnées
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#anomalies-et-divers">
   Anomalies et divers
  </a>
 </li>
</ul>

</nav>
</div>

<div class="toc-item">
  
<div id="searchbox"></div>
</div>

<div class="toc-item">
  
</div>

<div class="toc-item">
  
<div class="tocsection sourcelink">
    <a href="../_sources/changelog/v0_4_0_beta.md.txt">
        <i class="fa-solid fa-file-lines"></i> Montrer le code source
    </a>
</div>

</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1e1de1a1873e13ef5536"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2022, République française.<br>

</p>

  </div>
  
  <div class="footer-item">
    
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>

  </div>
  
</div>
  </footer>
  </body>
</html>